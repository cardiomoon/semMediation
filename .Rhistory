annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,arrow=arrow(angle=10,lty=2))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,arrow=arrow(angle=10,type="closed"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,
arrow=arrow(angle=10,length=unit(0.1,"inches"),type="closed"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,
arrow=arrow(angle=10,type="closed"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
install.packages("jtools")
install.packages("huxtable")
install.packages("ggstance")
disaster=read.csv("./inst/pmacro/data/disaster.csv",stringsAsFactors = FALSE)
disaster
data=disaster;Y="justify";X="skeptic";M="frame"
probs=c(0.16,0.5,0.84)
# data=disaster;Y="justify";X="skeptic";M="frame"
# probs=c(0.16,0.5,0.84)
temp=paste0(Y,"~",X,"*",M)
fit=lm(as.formula(temp),data=data)
summary(fit)
fun0=function(x) {fit$coef[1]+fit$coef[2]*x}
fun1=function(x) {fit$coef[1]+fit$coef[3]+(fit$coef[2]+fit$coef[4])*x}
modValues=quantile(data[[X]],probs=probs)
modValues
yhat1=fun0(modValues)
yhat2=fun1(modValues)
df=data.frame(x=modValues,y0=yhat1,y1=yhat2)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
require(jtools)
require(ggstance)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
require(ggplot2)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
shiny::runApp('inst/pmacro')
library(semMediation)
runApp()
runApp()
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
modValues
fit1=lm(justify~frame*I(skeptic-modValues[1]),data=disaster)
summary(fit1)
fit1=lm(justify~frame*I(skeptic-modValues[3]),data=disaster)
summary(fit1)
fit1=lm(justify~frame*I(skeptic-modValues[2]),data=disaster)
summary(fit1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="blue",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="open"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=1,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
fit1=lm(justify~frame*I(skeptic-modValues[2]),data=disaster)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
df=data.frame(x=modValues,y0=yhat1,y1=yhat2)
df
fit1=lm(justify~frame*I(skeptic-modValues[2]),data=disaster)
summary(fit1)
summary(fit1)
fit1$coef[2]
summary(fit1)
str(summary(fit1))
fit1$coef
summary(fit1)$coef
summary(fit1)$coef[2,4]
i=1
temp=paste0(Y,"~",X,"*I(",M,"-",modValues[i],")")
temp
effect<-p<-c()
# data=disaster;Y="justify";X="skeptic";M="frame"
# probs=c(0.16,0.5,0.84)
temp=paste0(Y,"~",X,"*",M)
fit=lm(as.formula(temp),data=data)
summary(fit)
fun0=function(x) {fit$coef[1]+fit$coef[2]*x}
fun1=function(x) {fit$coef[1]+fit$coef[3]+(fit$coef[2]+fit$coef[4])*x}
modValues=quantile(data[[X]],probs=probs)
modValues
yhat1=fun0(modValues)
yhat2=fun1(modValues)
effect<-p<-c()
for(i in 1:length(modValues)){
temp1=paste0(Y,"~",X,"*I(",M,"-",modValues[i],")")
fit1=lm(as.formula(temp),data=data)
effect=c(effect,fit1$coef[2])
p<-c(p,summary(fit1)$coef[2,4])
}
df=data.frame(x=modValues,y0=yhat1,y1=yhat2,effect=effect,p=p)
df
effect<-p<-c()
for(i in 1:length(modValues)){
temp1=paste0(Y,"~",X,"*I(",M,"-",modValues[i],")")
fit1=lm(as.formula(temp),data=data)
effect=c(effect,fit1$coef[2])
p<-c(p,summary(fit1)$coef[2,4])
}
p
effect
for(i in 1:length(modValues)){
temp1=paste0(Y,"~",X,"*I(",M,"-",modValues[i],")")
fit1=lm(as.formula(temp1),data=data)
effect=c(effect,fit1$coef[2])
p<-c(p,summary(fit1)$coef[2,4])
}
effect
effect<-p<-c()
for(i in 1:length(modValues)){
temp1=paste0(Y,"~",X,"*I(",M,"-",modValues[i],")")
fit1=lm(as.formula(temp1),data=data)
effect=c(effect,fit1$coef[2])
p<-c(p,summary(fit1)$coef[2,4])
}
effect
p
df=data.frame(x=modValues,y0=yhat1,y1=yhat2,effect=effect,p=p)
df
fit1=lm(justify~frame*I(skeptic-modValues[2]),data=disaster)
str(summary(fit1))
summary(fit1)$coef[2,4]
fit1$coef
fit1$coef[2]
df
effect<-p<-c()
for(i in 1:length(modValues)){
temp1=paste0(Y,"~",X,"*I(",M,"-",modValues[i],")")
fit1=lm(as.formula(temp1),data=data)
effect=c(effect,fit1$coef[2])
p<-c(p,summary(fit1)$coef[2,4])
}
effect
p
fit1=lm(justify~frame*I(skeptic-modValues[2]),data=disaster)
fit1$coef[2]
effect<-p<-c()
for(i in 1:length(modValues)){
temp1=paste0(Y,"~",X,"*I(",M,"-",modValues[i],")")
fit1=lm(as.formula(temp1),data=data)
effect=c(effect,fit1$coef[2])
p<-c(p,summary(fit1)$coef[2,4])
}
effect
effect<-p<-c()
for(i in 1:length(modValues)){
temp1=paste0(Y,"~",X,"*I(",M,"-",modValues[i],")")
fit1=lm(as.formula(temp1),data=data)
effect=c(effect,fit1$coef[1])
p<-c(p,summary(fit1)$coef[2,4])
}
effect
for(i in 1:length(modValues)){
temp1=paste0(Y,"~",X,"*I(",M,"-",modValues[i],")")
fit1=lm(as.formula(temp1),data=data)
effect=c(effect,fit1$coef[2])
p<-c(p,summary(fit1)$coef[2,4])
}
effect
effect<-p<-c()
for(i in 1:length(modValues)){
temp1=paste0(Y,"~",M,"*I(",X,"-",modValues[i],")")
fit1=lm(as.formula(temp1),data=data)
effect=c(effect,fit1$coef[2])
p<-c(p,summary(fit1)$coef[2,4])
}
effect
p
df=data.frame(x=modValues,y0=yhat1,y1=yhat2,effect=effect,p=p)
df
df
df$label=
}
df$label=paste0("theta|X->Y(W=",df$x,")=",
sprintf("%4.3f",df$effect),
",p=",sprintf("%.3f",df$p))
df
df$label=paste0("theta|italic(X->Y)(italic(W)=",df$x,")=",
sprintf("%4.3f",df$effect),
",italic(p)=",sprintf("%.3f",df$p))
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
df
df$label=paste0("theta|italic(X->Y)(italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%.3f",df$p))
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
df$label=paste0("list(theta|italic(X->Y)(italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%.3f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
df$label=paste0("list(theta|italic(X)->italic(Y)(italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%3.3f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
fit1=lm(justify~frame*I(skeptic-modValues[2]),data=disaster)
df$label=paste0("list(theta | italic(X) -> italic(Y)(italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%3.3f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
fit1=lm(justify~frame*I(skeptic-modValues[2]),data=disaster)
df
df$label=paste0("list(theta | [italic(X) -> italic(Y)](italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%3.3f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
df$label=paste0("list(theta | [italic(X)", "->"," italic(Y)](italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%3.3f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
df$label=paste0("list(theta | italic(X)", "->"," italic(Y)(italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%3.3f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
df$label=paste0("list(theta | italic(X)", "->"," italic(Y)(italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%.3f",df$p),")")
df
df$label=paste0("list(theta | italic(X)", "->"," italic(Y)(italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%.03f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
df$label=paste0("list(theta | italic(X) %->% italic(Y)(italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%.03f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
df$label=paste0("list(theta [italic(X) %->% italic(Y)] (italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%.03f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
df$label=paste0("list(theta [italic(X) %->% italic(Y)] | (italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%.03f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label,parse=TRUE)
fit1=lm(justify~frame*I(skeptic-modValues[2]),data=disaster)
df$label1=paste0("theta [italic(X) %->% italic(Y)]")
df$label2=paste0("(italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%.03f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.1)+
fit1=lm(justify~frame*I(skeptic-modValues[2]),data=disaster)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.1)
df
df$label1=paste0("theta [italic(X) %->% italic(Y)]")
df$label2=paste0("list((italic(W)==",df$x,")==",
sprintf("%4.3f",df$effect),
",italic(p)==",sprintf("%.03f",df$p),")")
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=0)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1)+
annotate("text",x=df$x,y=df$y1,label="|")+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1)+
annotate("text",x=df$x,y=df$y1,label="|")+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01)
df$vjust=ifelse(df$effect>=0,1,0)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01,vjust=df$vjust)
df$vjust=ifelse(df$effect>=0,2,-2)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01,vjust=df$vjust)
df$vjust=ifelse(df$effect>=0,-2,2)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01,vjust=df$vjust)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01,vjust=df$vjust)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,nudge_y=df$vjust)+
annotate("text",x=df$x,y=df$y1,label="|",nudge_y=df$vjust)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01,nudge_y=df$vjust)
df$vjust=ifelse(df$effect>=0,-20,20)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,nudge_y=df$vjust)+
annotate("text",x=df$x,y=df$y1,label="|",nudge_y=df$vjust)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01,nudge_y=df$vjust)
df$vjust=ifelse(df$effect>=0,-2,2)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=df$vjust)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01,vjust=df$vjust)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1)+
annotate("text",x=df$x,y=df$y1,label="|")+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=0)+
annotate("text",x=df$x,y=df$y1,label="|",hjust=-1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-1.1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=0,vjust=0)+
annotate("text",x=df$x,y=df$y1,label="|",hjust=-0.1,vjust=0)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.5,vjust=0)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=0,vjust=-1)+
annotate("text",x=df$x,y=df$y1,label="|",hjust=-0.2,vjust=-1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.3,vjust=-1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=0,vjust=1)+
annotate("text",x=df$x,y=df$y1,label="|",hjust=-0.2,vjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.3,vjust=1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=0,vjust=1)+
annotate("text",x=df$x,y=df$y1,label="|",hjust=-0.3,vjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.3,vjust=1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1,vjust=1)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=0,vjust=1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,vjust=1)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=0,vjust=1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,vjust=1)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.1,vjust=1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,vjust=1)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01,vjust=1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1,label=df$label1,parse=TRUE,hjust=1.1,vjust=1)+
annotate("text",x=df$x,y=df$y1,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1,label=df$label2,parse=TRUE,hjust=-0.01,vjust=1)
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label1,parse=TRUE,hjust=1.1,vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label2,parse=TRUE,hjust=-0.01,vjust=1)
df$vjust=ifelse(df$effect>=0,1,-1)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label1,parse=TRUE,hjust=1.1,vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label2,parse=TRUE,hjust=-0.01,vjust=1)
df$vjust=ifelse(df$effect>=0,0.1,-0.1)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label1,parse=TRUE,hjust=1.1,vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label2,parse=TRUE,hjust=-0.01,vjust=1)
df$vjust=ifelse(df$effect>=0,0.5,-0.1)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label1,parse=TRUE,hjust=1.1,vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label2,parse=TRUE,hjust=-0.01,vjust=1)
df$vjust=ifelse(df$effect>=0,0.2,-0.1)
df
interact_plot(fit,pred = skeptic,modx=frame)+
annotate("segment",x=df$x,y=df$y0,xend=df$x,yend=df$y1,lty=2,color="red",
arrow=arrow(angle=10,length=unit(0.15,"inches"),type="closed"))+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label1,parse=TRUE,hjust=1.1,vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label="|",vjust=1)+
annotate("text",x=df$x,y=df$y1+df$vjust,label=df$label2,parse=TRUE,hjust=-0.01,vjust=1)
