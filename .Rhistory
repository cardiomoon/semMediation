covar
temp3=seekVar(covar=covar,var=var,prefix=prefix,start=start)
temp3
if(is.null(temp3)){
result[[i]]=paste(var,"~",temp2[[i]][2])
} else {
temp4=paste(temp2[[i]][2],"+",paste(temp3,collapse=" + "))
result[[i]]=paste(var,"~",temp4)
start=start+length(temp3)
}
}
paste(unlist(result),collapse="\n")
}
equation="Y ~ X*W"
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
addCovarEquation(equation,covar=covar,prefix=NULL)
equation="M ~ X*W"
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
addCovarEquation(equation,covar=covar,prefix=NULL)
#' @param covar A list of covariates
#' @param mode A number
#' @export
#' @examples
#' X="negemot";M="ideology";Y="govact";vars=c("sex","age");site=c("a","b","c");suffix=0
#' covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
#' cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site))
#' cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site,covar=covar))
#' cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site,mode=1))
#' cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site,covar=covar,mode=1))
tripleEquation=function(X=NULL,M=NULL,Y=NULL,vars,site,suffix=0,covar=NULL,mode=0){
temp1<-temp2<-temp3<-NULL
if("a" %in% site) {
newvars=c(X,vars)
temp1=tripleInteraction(newvars,prefix="a",suffix=suffix,mode=mode)
temp1=paste0(M,"~",paste(temp1,collapse="+"))
if(!is.null(covar)){
covar$site=lapply(covar$site,function(x) str_replace(x,"M",M))
if(mode){
temp1=addCovarEquation(temp1,covar,prefix=NULL)
} else{
temp1=addCovarEquation(temp1,covar)
}
}
suffix=suffix+1
}
if("b" %in% site) {
newvars=c(M,vars)
temp2=tripleInteraction(newvars,prefix="b",suffix=suffix,mode=mode)
suffix=suffix+1
}
if("c" %in% site) {
newvars=c(X,vars)
temp3=tripleInteraction(newvars,suffix=suffix,mode=mode)
}
temp=c(temp2,temp3)
temp=paste0(Y,"~",paste(temp,collapse="+"))
if(!is.null(covar)){
covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
if(mode){
temp=addCovarEquation(temp,covar,prefix=NULL)
} else{
temp=addCovarEquation(temp,covar)
}
}
temp=c(temp1,temp)
equation=paste(temp,collapse="\n")
equation
}
X="negemot";M="ideology";Y="govact";vars=c("sex","age");site=c("a","b","c");suffix=0
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site,covar=covar))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site,mode=1))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site,covar=covar,mode=1))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site,covar=covar))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site,mode=1))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars,site=site,covar=covar,mode=1))
runApp('inst/pmacro')
runApp('inst/pmacro')
library(semMediation)
devtools::document()
devtools::document()
devtools::document()
library(semMediation)
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
pmacroModel(3)
pmacro
pmacro[pmacro!no==c(7:8),]
pmacro[pmacro!no %in% c(7:8),]
pmacro[pmacro$no %in% c(7:8),]
pmacro=rbind(pmacro,pmacro[pmacro$no %in% c(7:8),])
tail(pmacroquantile(df$sexism,c(0.16,0.5,0.84),type=6)
tail(pmacro)
tail(pmacro)
nrow(pmacro)
pmacro=rbind(pmacro,pmacro[47,])
tail(pmacro)
nrow(pmacro)
pmacro$no[46]
pmacro$no[46]=11
pmacro$no[47]=12
pmacro$no[48]=13
tail(pmacro)
pmacro=rbind(pmacro,pmacro[pmacro$no %in% c(14),])
tail(pmacro)
pmacro$no[49]=18
tail(pmacro)
pmacro=rbind(pmacro,pmacro[pmacro$no %in% c(15),])
tail(pmacro)
pmacro$no[50]=19
pmacro=rbind(pmacro,pmacro[pmacro$no %in% c(15),])
tail(pmacro)
pmacro$no[51]=20
tail(pmacro)
pmacro$modeName(pmacro$no %in% c(14,15,18,19,20))
pmacro$modeName[pmacro$no %in% c(14,15,18,19,20)]
pmacro$modeName[pmacro$no %in% c(14,15,18,19,20)]
pmacro$modeName[pmacro$no==14]
pmacro$modeName
pmacro
pmacro$modeName
str(pmacro)
pmacro$modeName
pmacro$no
pmacro$modName[pmacro$no %in% c(14,15,18,19,20)]
pmacro$modName[pmacro$no %in% c(14,15,18,19,20)]="W"
nodes
nodes[nodes$no %in% c(14,15,18,19,20),]
nodes$name[59,64]
nodes$name[c(59,64)]
nodes$name[c(59,64)]="W"
arrows[arrows$no %in% c(14,15),]
nodes[nodes$no %in% c(14,15,18,19,20),]
nodes$name[c(60,65)]="MiW"
nodes$name[66]="XW"
arrows[arrows$no %in% c(14,15),]
arrows$start[c(68,73)]
arrows$start[c(68,73)]="W"
arrows[arrows$no %in% c(14,15),]
arrows$start[c(69,74)]="MiW"
arrows$start[c(75)]="XW"
nodes[nodes$no %in% c(7,8,11:13),]
devtools::use_data(pmacro,overwrite=TRUE)
devtools::use_data(nodes,overwrite=TRUE)
devtools::use_data(arrows,overwrite=TRUE)
nodes[nodes$no %in% c(7,8,11:13),]
pmacroModel(11)
pmacroModel(7)
pmacroModel(11)
pmacro[pmacro$no %in% c(7,8,11:13),]
runApp('inst/pmacro')
library(semMediation)
pmacroModel(3)
pmacroModel(7)
library(semMediation)
runApp('inst/pmacro')
library(semMediation)
runApp('inst/pmacro')
runApp('inst/pmacro')
library(semMediation)
runApp('inst/pmacro')
library(semMediation)
runApp('inst/pmacro')
library(semMediation)
runApp('inst/pmacro')
library(semMediation)
runApp('inst/pmacro')
library(semMediation)
runApp('inst/pmacro')
library(semMediation)
pmacroModel(11)
library(semMediation)
pmacroModel(11)
library(semMediation)
pmacroModel(11)
library(semMediation)
pmacroModel(11)
library(semMediation)
pmacroModel(11)
library(semMediation)
library(semMediation)
pmacroModel(11)
library(semMediation)
pmacroModel(11)
pmacroModel(7)
library(semMediation)
pmacroModel(7)
pmacroModel(11)
library(semMediation)
pmacroModel(7)
pmacroModel(11)
library(semMediation)
pmacroModel(7)
pmacroModel(11)
library(semMediation)
pmacroModel(7)
pmacroModel(11)
pmacroModel(12)
pmacroModel(11)
pmacroModel(12)
pmacroModel(11)
pmacroModel(12)
library(semMediation)
pmacroModel(7)
pmacroModel(11)
pmacroModel(12)
pmacroModel(8)
library(semMediation)
pmacroModel(11)
pmacroModel(12)
library(semMediation)
pmacroModel(11)
pmacroModel(12)
library(semMediation)
library(semMediation)
pmacroModel(7)
pmacroModel(8)
pmacroModel(11)
pmacroModel(12)
pmacroModel(13)
library(semMediation)
pmacroModel(11)
pmacroModel(12)
pmacroModel(13)
library(semMediation)
pmacroModel(11)
pmacroModel(12)
pmacroModel(13)
pmacroModel(12)
pmacroModel(18)
pmacroModel(19)
pmacroModel(20)
library(semMediation)
pmacroModel(13)
pmacroModel(13)
pmacroModel(11)
pmacroModel(12)
pmacroModel(13)
pmacroModel(11)
pmacroModel(12)
pmacroModel(13)
pmacroModel(18)
pmacroModel(19)
pmacroModel(20)
pmacroModel(18)
library(semMediation)
pmacroModel(18)
pmacroModel(19)
pmacroModel(20)
pmacroModel(19)
library(semMediation)
pmacroModel(18)
pmacroModel(19)
pmacroModel(20)
runApp('inst/pmacro')
nodes[nodes$no==3,]
nodes=rbind(nodes,nodes[nodes$no==3,])
tail(nodes,10)
nodes<-editData::editData(nodes)
tail(nodes,10)
nodes<-editData::editData(nodes)
devtools::use_data(nodes,overwrite=TRUE)
runApp('inst/pmacro')
arrows[arrows$no==3,]
arrows[arrows$no==3,]
arrows=rbind(arrows,arrows[arrows$no==3,])
tail(arrows,10)
tail(arrows,12)
tail(arrows,24)
tail(nodes,10)
tail(arrows,10)
arrows<-editData::editData(arrows)
tail(arrows,10)
devtools::use_data(arrows,overwrite=TRUE)
runApp('inst/pmacro')
tail(arrows,10)
devtools::use_data(arrows,overwrite=TRUE)
statisticalDiagram(10)
statisticalDiagram(11)
statisticalDiagram(10)
statisticalDiagram(11)
no=11;radx=0.10;rady=0.04;xmargin=0.01;arrowlabel=TRUE;labels=list()
whatLabel="est"
estimateTable=res;
if(no==1.1) {
nodes=est2Nodes(estimateTable)
} else {
nodes=nodes[nodes$no==no, ]
}
if(no==1.1){
arrows1=est2Arrows(estimateTable)
} else{
arrows1=arrows[arrows$no==no,]
}
nodes
runApp('inst/pmacro')
no=11;radx=0.10;rady=0.04;xmargin=0.01;arrowlabel=TRUE;labels=list()
whatLabel="est"
no=11;radx=0.10;rady=0.04;xmargin=0.01;arrowlabel=TRUE;labels=list()
whatLabel="name";estimateTable=NULL;covar=list()
if(no==1.1) {
nodes=est2Nodes(estimateTable)
} else {
nodes=nodes[nodes$no==no, ]
}
if(no==1.1){
arrows1=est2Arrows(estimateTable)
} else{
arrows1=arrows[arrows$no==no,]
}
nodes
tail(nodes)
library(semMediation)
nodes
tail(nodes)
no=11;radx=0.10;rady=0.04;xmargin=0.01;arrowlabel=TRUE;labels=list()
whatLabel="name";estimateTable=NULL;covar=list()
if(no==1.1) {
nodes=est2Nodes(estimateTable)
} else {
nodes=nodes[nodes$no==no, ]
}
if(no==1.1){
arrows1=est2Arrows(estimateTable)
} else{
arrows1=arrows[arrows$no==no,]
}
nodes
# Add covariates
if(no!=1.1) nodes=addNodes(nodes,covar,radx=radx,rady=rady,no=no)
# print(nodes)
arrows1
statisticalDiagram(10)
statisticalDiagram(11)
tail(nodes)
tail(nodes,10)
nodes
tail(nodes,10)
nrows(nodes)
nrow(nodes)
nrow(nodes)[356]
nodes$xpos[356]
nodes$xpos[356]=0.2
nodes<-editData::editData(nodes)
tail(nodes,10)
nodes=rbind(nodes,nodes[356,])
nodes<-editData::editData(nodes)
tail(nodes,10)
statisticalDiagram(11)
nodes<-editData::editData(nodes)
statisticalDiagram(11)
devtools::use_data(nodes,overwrite=TRUE)
tail(arrows,10)
arrows=rbind(arrows,arrows[arrows$no==11,])
arrows<-editData::editData(arrows)
tail(arrows,10)
nrow(arrows)
arrows[423:424,]
nrow(arrows)
arrows=arrows[-c(424:428),]
nrow(arrows)
tail(arrows,10)
devtools::use_data(arrows,overwrite=TRUE)
statisticalDiagram(11)
arrows<-editData::editData(arrows)
statisticalDiagram(11)
arrows<-editData::editData(arrows)
statisticalDiagram(11)
arrows<-editData::editData(arrows)
statisticalDiagram(11)
devtools::use_data(arrows,overwrite=TRUE)
nodes=rbind(nodes,nodes[nodes$no==11,])
nodes<-editData::editData(nodes)
nodes=rbind(nodes,nodes[nodes$no==11,])
nodes<-editData::editData(nodes)
arrows=rbind(arrows,arrows[arrows$no==11,])
arrows<-editData::editData(arrows)
arrows=rbind(arrows,arrows[arrows$no==12,])
arrows<-editData::editData(arrows)
arrows<-editData::editData(arrows)
devtools::use_data(nodes,overwrite=TRUE)
devtools::use_data(arrows,overwrite=TRUE)
statisticalDiagram(11)
statisticalDiagram(12)
arrows<-editData::editData(arrows)
statisticalDiagram(11)
statisticalDiagram(12)
arrows<-editData::editData(arrows)
statisticalDiagram(12)
devtools::use_data(nodes,overwrite=TRUE)
devtools::use_data(arrows,overwrite=TRUE)
arrows=rbind(arrows,arrows[arrows$no==12,])
arrows<-editData::editData(arrows)
devtools::use_data(arrows,overwrite=TRUE)
statisticalDiagram(12)
statisticalDiagram(11)
statisticalDiagram(12)
statisticalDiagram(13)
runApp('inst/pmacro')
statisticalDiagram(6.4)
arrows<-editData::editData(arrows)
statisticalDiagram(6.4)
arrows<-editData::editData(arrows)
statisticalDiagram(9)
arrows<-editData::editData(arrows)
statisticalDiagram(9)
statisticalDiagram(10)
arrows<-editData::editData(arrows)
statisticalDiagram(60)
statisticalDiagram(61)
statisticalDiagram(62)
statisticalDiagram(63)
arrows<-editData::editData(arrows)
statisticalDiagram(60)
statisticalDiagram(61)
statisticalDiagram(62)
statisticalDiagram(63)
statisticalDiagram(61)
statisticalDiagram(60)
statisticalDiagram(61)
statisticalDiagram(62)
statisticalDiagram(63)
statisticalDiagram(11)
statisticalDiagram(10)
statisticalDiagram(11)
statisticalDiagram(12)
statisticalDiagram(13)
nodes[nodes$no %in% 11:13,]
nodes=rbind(nodes,nodes[nodes$no %in% 11:13,])
nodes<-editData::editData(nodes)
devtools::use_data(nodes,overwrite=TRUE)
arrows=rbind(arrows,arrows[arrows$no %in% 11:13,])
arrows<-editData::editData(arrows)
arrows[441:nrow(arrows),]
arrows[450:nrow(arrows),]
arrows$no[450:458]
arrows$no[450:458]=12
arrows[459:477]
arrows$no[459:477]
arrows$no[459:474]
arrows$no[459:473]
arrows$no[474:nrow(arrows)]=
nodes<-editData::editData(nodes)
arrows$no[474:nrow(arrows)]
arrows$no[474:nrow(arrows)]=20
arrows$no[450:458]=18
arrows<-editData::editData(arrows)
arrows$no[450:458]=18
arrows$no[459:473]=19
arrows$no[474:nrow(arrows)]=20
arrows<-editData::editData(arrows)
devtools::use_data(nodes,overwrite=TRUE)
devtools::use_data(arrows,overwrite=TRUE)
statisticalDiagram(18)
statisticalDiagram(19)
statisticalDiagram(20)
statisticalDiagram(18)
statisticalDiagram(19)
statisticalDiagram(20)
statisticalDiagram(18)
nodes<-editData::editData(nodes)
statisticalDiagram(20)
nodes<-editData::editData(nodes)
statisticalDiagram(20)
nodes[nrow(modes),]
nodes[nrow(nodes),]
nodes=rbind(nodes,nodes[nrow(nodes),])
nodes<-editData::editData(nodes)
statisticalDiagram(20)
nodes<-editData::editData(nodes)
statisticalDiagram(20)
arrows<-editData::editData(arrows)
arrows=rbind(arrows,arrows[nrow(arrows),])
arrows<-editData::editData(arrows)
statisticalDiagram(20)
arrows<-editData::editData(arrows)
arrows=rbind(arrows,arrows[nrow(arrows),])
arrows<-editData::editData(arrows)
statisticalDiagram(20)
arrows<-editData::editData(arrows)
statisticalDiagram(20)
statisticalDiagram(18)
statisticalDiagram(19)
statisticalDiagram(18)
arrows<-editData::editData(arrows)
statisticalDiagram(18)
statisticalDiagram(19)
statisticalDiagram(18)
statisticalDiagram(19)
statisticalDiagram(20)
statisticalDiagram(19)
nodes<-editData::editData(nodes)
nodes<-editData::editData(nodes)
arrows=rbind(arrows,arrows[arrows$no %in% 19,])
nodes=rbind(nodes,nodes[nodes$no %in% 19,])
nodes<-editData::editData(nodes)
statisticalDiagram(19)
nodes<-editData::editData(nodes)
statisticalDiagram(19)
arrows<-editData::editData(arrows)
statisticalDiagram(19)
nodes<-editData::editData(nodes)
statisticalDiagram(19)
statisticalDiagram(18)
statisticalDiagram(20)
devtools::use_data(pmacro,overwrite=TRUE)
devtools::use_data(nodes,overwrite=TRUE)
devtools::use_data(arrows,overwrite=TRUE)
runApp('inst/pmacro')
