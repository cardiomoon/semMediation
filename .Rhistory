statisticalDiagram(no=24,radx=0.08)
statisticalDiagram(no=28)
statisticalDiagram(no=29)
statisticalDiagram(no=76,radx=0.06)
statisticalDiagram(no=14)
statisticalDiagram(no=15)
statisticalDiagram(no=16)
statisticalDiagram(no=17)
statisticalDiagram(no=21)
statisticalDiagram(no=22)
statisticalDiagram(no=23)
statisticalDiagram(no=23,radx=0.08)
statisticalDiagram(no=23)
statisticalDiagram(no=23,radx=0.08)
statisticalDiagram(no=23)
statisticalDiagram(no=23,radx=0.08)
statisticalDiagram(no=24,radx=0.08)
statisticalDiagram(no=28)
statisticalDiagram(no=23)
statisticalDiagram(no=23)
statisticalDiagram(no=24)
statisticalDiagram(no=23)
statisticalDiagram(no=23)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=30)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=30)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=22)
statisticalDiagram(no=23)
statisticalDiagram(no=22)
statisticalDiagram(no=23)
statisticalDiagram(no=24)
statisticalDiagram(no=23)
statisticalDiagram(no=23)
statisticalDiagram(no=24)
statisticalDiagram(no=22)
statisticalDiagram(no=23)
statisticalDiagram(no=24)
statisticalDiagram(no=23)
statisticalDiagram(no=24)
statisticalDiagram(no=23,radx=0.08)
statisticalDiagram(no=24,radx=0.08)
statisticalDiagram(no=28)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=31)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=76,radx=0.06)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=76,radx=0.06)
statisticalDiagram(no=32)
statisticalDiagram(no=32)
statisticalDiagram(no=32)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=32)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=36)
statisticalDiagram(no=23)
statisticalDiagram(no=24)
statisticalDiagram(no=76)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=32)
statisticalDiagram(no=31)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=32)
statisticalDiagram(no=32)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=36)
statisticalDiagram(no=40)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=36)
statisticalDiagram(no=41)
statisticalDiagram(no=36)
statisticalDiagram(no=40)
statisticalDiagram(no=41)
statisticalDiagram(no=17)
statisticalDiagram(no=21)
statisticalDiagram(no=22)
statisticalDiagram(no=23)
statisticalDiagram(no=24)
statisticalDiagram(no=28)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=36)
statisticalDiagram(no=40)
statisticalDiagram(no=41)
statisticalDiagram(no=76,radx=0.06)
statisticalDiagram(no=76,radx=0.12)
statisticalDiagram(no=41)
statisticalDiagram(no=40)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=36)
statisticalDiagram(no=31)
statisticalDiagram(no=31)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=40)
statisticalDiagram(no=41)
statisticalDiagram(no=45)
statisticalDiagram(no=41)
statisticalDiagram(no=45)
statisticalDiagram(no=45,radx=0.06)
statisticalDiagram(no=45)
statisticalDiagram(no=49)
statisticalDiagram(no=49)
statisticalDiagram(no=45)
statisticalDiagram(no=40)
statisticalDiagram(no=41)
statisticalDiagram(no=45)
statisticalDiagram(no=45)
statisticalDiagram(no=45)
statisticalDiagram(no=45)
statisticalDiagram(no=40)
statisticalDiagram(no=41)
statisticalDiagram(no=45)
statisticalDiagram(no=45,radx=0.06)
statisticalDiagram(no=49)
statisticalDiagram(no=49)
statisticalDiagram(no=50)
statisticalDiagram(no=49)
statisticalDiagram(no=50)
statisticalDiagram(no=49)
statisticalDiagram(no=50)
statisticalDiagram(no=51)
statisticalDiagram(no=50)
statisticalDiagram(no=51)
statisticalDiagram(no=40)
statisticalDiagram(no=50)
statisticalDiagram(no=51)
statisticalDiagram=function(no=1,radx=0.10,rady=0.04,xmargin=0.01){
nodes=read.csv("./R/node.csv",stringsAsFactors = FALSE)
nodes
# nodes=nodes[1:19, ]
# write.csv(nodes,"./R/node.csv",row.names = FALSE)
arrows=read.csv("./R/arrow.csv",stringsAsFactors = FALSE)
arrows
#  arrows=arrows[1:19, ]
#  write.csv(arrows,"./R/arrow.csv",row.names = FALSE)
# no=76;radx=0.12;rady=0.04;xmargin=0.03
#  nodes
#  arrows
nodes=nodes[nodes$no==no, ]
arrows=arrows[arrows$no==no,]
openplotmat()
for(i in 1:nrow(arrows)){
myarrow2(from=arrows$start[i],to=arrows$end[i],
label=arrows$name[i],no=no,xmargin=xmargin,radx=radx,rady=rady,
label.pos=arrows$labelpos[i],arr.pos=arrows$arrpos[i])
}
for(i in 1:nrow(nodes)){
xpos=nodes$xpos[i]
xpos=adjustxpos(xpos,xmargin,radx)
mid=c(xpos,nodes$ypos[i])
drawtext(mid,radx=radx,rady=rady,lab=nodes$name[i],latent=FALSE)
}
}
statisticalDiagram(no=49)
statisticalDiagram(no=50)
statisticalDiagram(no=51)
statisticalDiagram=function(no=1,radx=0.10,rady=0.04,xmargin=0.01){
nodes=read.csv("./R/node.csv",stringsAsFactors = FALSE)
nodes
# nodes=nodes[1:19, ]
# write.csv(nodes,"./R/node.csv",row.names = FALSE)
arrows=read.csv("./R/arrow.csv",stringsAsFactors = FALSE)
arrows
#  arrows=arrows[1:19, ]
#  write.csv(arrows,"./R/arrow.csv",row.names = FALSE)
# no=76;radx=0.12;rady=0.04;xmargin=0.03
#  nodes
#  arrows
nodes=nodes[nodes$no==no, ]
arrows=arrows[arrows$no==no,]
openplotmat()
for(i in 1:nrow(arrows)){
myarrow2(from=arrows$start[i],to=arrows$end[i],
label=arrows$name[i],no=no,xmargin=xmargin,radx=radx,rady=rady,
label.pos=arrows$labelpos[i],arr.pos=arrows$arrpos[i])
}
for(i in 1:nrow(nodes)){
xpos=nodes$xpos[i]
xpos=adjustxpos(xpos,xmargin,radx)
mid=c(xpos,nodes$ypos[i])
drawtext(mid,radx=radx,rady=rady,lab=nodes$name[i],latent=FALSE)
}
}
myarrow2=function(from,to,label="",no,radx=0.12,rady=0.04,xmargin=0.01,label.pos=0.5,arr.pos=NULL,...){
nodes=read.csv("./R/node.csv",stringsAsFactors = FALSE)
nodes=nodes[nodes$no==no, ]
# from="X";no=1;to="Y";label="66"
xpos=nodes$xpos[nodes$name==from]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==from]
start=c(xpos,ypos)
xpos=nodes$xpos[nodes$name==to]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==to]
end=c(xpos,ypos)
if(nchar(label)>1) {
if(nchar(label==3)){
temp1=paste0("expression(",substr(label,1,1),"[",substr(label,2,2),"]","[",substr(label,3,nchar(label)),"])")
} else{
temp2=substr(label,2,nchar(label))
temp2
temp1=paste0("expression(",substr(label,1,1),"[",temp2,"])")
temp1
}
temp=eval(parse(text=temp1))
label=temp
}
myarrow(from=start,to=end,label=label,label.pos=label.pos,arr.pos=arr.pos,...)
}
statisticalDiagram(no=1)
statisticalDiagram(no=1)
myarrow2=function(from,to,label="",no,radx=0.12,rady=0.04,xmargin=0.01,label.pos=0.5,arr.pos=NULL,...){
nodes=read.csv("./R/node.csv",stringsAsFactors = FALSE)
nodes=nodes[nodes$no==no, ]
# from="X";no=1;to="Y";label="66"
xpos=nodes$xpos[nodes$name==from]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==from]
start=c(xpos,ypos)
xpos=nodes$xpos[nodes$name==to]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==to]
end=c(xpos,ypos)
if(nchar(label)>1) {
if(nchar(label==3)){
temp1=paste0("expression(",substr(label,1,1),"[",substr(label,2,2),"]","[",substr(label,3,nchar(label)),"])")
} else{
temp2=substr(label,2,nchar(label))
temp2
temp1=paste0("expression(",substr(label,1,1),"[",temp2,"])")
temp1
}
temp=eval(parse(text=temp1))
label=temp
}
myarrow(from=start,to=end,label=label,label.pos=label.pos,arr.pos=arr.pos,...)
}
statisticalDiagram(no=1)
no=1;radx=0.10;rady=0.04;xmargin=0.01
nodes=read.csv("./R/node.csv",stringsAsFactors = FALSE)
nodes
# nodes=nodes[1:19, ]
# write.csv(nodes,"./R/node.csv",row.names = FALSE)
arrows=read.csv("./R/arrow.csv",stringsAsFactors = FALSE)
arrows
#  arrows=arrows[1:19, ]
#  write.csv(arrows,"./R/arrow.csv",row.names = FALSE)
# no=76;radx=0.12;rady=0.04;xmargin=0.03
#  nodes
#  arrows
nodes=nodes[nodes$no==no, ]
arrows=arrows[arrows$no==no,]
arrows
openplotmat()
for(i in 1:nrow(arrows)){
myarrow2(from=arrows$start[i],to=arrows$end[i],
label=arrows$name[i],no=no,xmargin=xmargin,radx=radx,rady=rady,
label.pos=arrows$labelpos[i],arr.pos=arrows$arrpos[i])
}
for(i in 1:nrow(nodes)){
xpos=nodes$xpos[i]
xpos=adjustxpos(xpos,xmargin,radx)
mid=c(xpos,nodes$ypos[i])
drawtext(mid,radx=radx,rady=rady,lab=nodes$name[i],latent=FALSE)
}
myarrow2=function(from,to,label="",no,radx=0.12,rady=0.04,xmargin=0.01,label.pos=0.5,arr.pos=NULL,...){
nodes=read.csv("./R/node.csv",stringsAsFactors = FALSE)
nodes=nodes[nodes$no==no, ]
# from="X";no=1;to="Y";label="66"
xpos=nodes$xpos[nodes$name==from]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==from]
start=c(xpos,ypos)
xpos=nodes$xpos[nodes$name==to]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==to]
end=c(xpos,ypos)
if(nchar(label)>1) {
if(nchar(label==3)){
temp1=paste0("expression(",substr(label,1,1),"[",substr(label,2,2),"]","[",substr(label,3,nchar(label)),"])")
} else{
temp2=substr(label,2,nchar(label))
temp2
temp1=paste0("expression(",substr(label,1,1),"[",temp2,"])")
temp1
}
temp=eval(parse(text=temp1))
label=temp
}
myarrow(from=start,to=end,label=label,label.pos=label.pos,arr.pos=arr.pos,...)
}
openplotmat()
for(i in 1:nrow(arrows)){
myarrow2(from=arrows$start[i],to=arrows$end[i],
label=arrows$name[i],no=no,xmargin=xmargin,radx=radx,rady=rady,
label.pos=arrows$labelpos[i],arr.pos=arrows$arrpos[i])
}
myarrow2=function(from,to,label="",no,radx=0.12,rady=0.04,xmargin=0.01,label.pos=0.5,arr.pos=NULL,...){
nodes=read.csv("./R/node.csv",stringsAsFactors = FALSE)
nodes=nodes[nodes$no==no, ]
# from="X";no=1;to="Y";label="66"
xpos=nodes$xpos[nodes$name==from]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==from]
start=c(xpos,ypos)
xpos=nodes$xpos[nodes$name==to]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==to]
end=c(xpos,ypos)
if(nchar(label)>1) {
if(nchar(label==3)){
temp1=paste0("expression(",substr(label,1,1),"[",substr(label,2,2),"]","[",substr(label,3,nchar(label)),"])")
} else{
temp2=substr(label,2,nchar(label))
temp2
temp1=paste0("expression(",substr(label,1,1),"[",temp2,"])")
temp1
}
temp=eval(parse(text=temp1))
label=temp
}
myarrow(from=start,to=end,label=label,label.pos=label.pos,arr.pos=arr.pos,...)
}
#' Draw arrow
#' @param from coordinates (x,y) of the point *from* which to draw arrow.
#' @param to coordinates (x,y) of the point *to* which to draw arrow.
#' @param lwd line width
#' @param adjust adjust position
#' @param label label
#' @param arr.pos arrow position
#' @param ... Further argument to be passed to straightarrow()
#' @importFrom diagram textplain straightarrow
myarrow=function(from,to,lwd=1,adjust=1,label="",label.pos=0.5,arr.pos=NULL,...){
if(!is.null(arr.pos)){
if(arr.pos==0) arr.pos<-NULL
}
if(is.null(arr.pos)){
if(adjust){
if(from[2]==to[2]) arr.pos=0.8
else if(from[2]>to[2]) arr.pos=0.7
else arr.pos=0.68
} else{
distance=abs(to[2]-from[2])+abs(to[1]-from[1])
if(distance<=0.23) {
arr.pos=0.86
} else if(distance>0.5){
arr.pos=0.95
} else{
arr.pos=0.94
}
}
distance=abs(to[2]-from[2])+abs(to[1]-from[1])
# str(distance)
# str(arr.pos)
}
mid=label.pos*(from+to)
textplain(mid=mid,lab=label,adj=c(1,-0.5))
straightarrow(from=from,to=to,lwd=lwd,arr.pos=arr.pos,arr.type="triangle",...)
}
#' Draw node
#' @param ... Further argument to be passed to textellipse() or textrect()
#' @param latent Logical
#' @importFrom diagram textellipse textrect
drawtext=function(...,latent=TRUE){
if(latent) textellipse(...)
else textrect(...)
}
midPoint=function(from=0,to=1,length.out=2){
res=seq(from,to,length.out = length.out+2)
res[c(-1,-length(res))]
}
require(diagram)
no=1;radx=0.10;rady=0.04;xmargin=0.01
statisticalDiagram=function(no=1,radx=0.10,rady=0.04,xmargin=0.01){
nodes=read.csv("./R/node.csv",stringsAsFactors = FALSE)
nodes
# nodes=nodes[1:19, ]
# write.csv(nodes,"./R/node.csv",row.names = FALSE)
arrows=read.csv("./R/arrow.csv",stringsAsFactors = FALSE)
arrows
#  arrows=arrows[1:19, ]
#  write.csv(arrows,"./R/arrow.csv",row.names = FALSE)
# no=76;radx=0.12;rady=0.04;xmargin=0.03
#  nodes
#  arrows
nodes=nodes[nodes$no==no, ]
arrows=arrows[arrows$no==no,]
openplotmat()
for(i in 1:nrow(arrows)){
myarrow2(from=arrows$start[i],to=arrows$end[i],
label=arrows$name[i],no=no,xmargin=xmargin,radx=radx,rady=rady,
label.pos=arrows$labelpos[i],arr.pos=arrows$arrpos[i])
}
for(i in 1:nrow(nodes)){
xpos=nodes$xpos[i]
xpos=adjustxpos(xpos,xmargin,radx)
mid=c(xpos,nodes$ypos[i])
drawtext(mid,radx=radx,rady=rady,lab=nodes$name[i],latent=FALSE)
}
}
adjustxpos=function(xpos,xmargin=0.01,radx=0.12){
ifelse(xpos==0.5,0.5,
ifelse(xpos>0.5,
1-xmargin-radx-(1.0-xpos)*10*(xmargin+2*radx),
xmargin+radx+(xpos)*10*(xmargin+2*radx)))
}
adjustxpos(1)
adjustxpos(0.9)
myarrow2=function(from,to,label="",no,radx=0.12,rady=0.04,xmargin=0.01,label.pos=0.5,arr.pos=NULL,...){
nodes=read.csv("./R/node.csv",stringsAsFactors = FALSE)
nodes=nodes[nodes$no==no, ]
# from="X";no=1;to="Y";label="66"
xpos=nodes$xpos[nodes$name==from]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==from]
start=c(xpos,ypos)
xpos=nodes$xpos[nodes$name==to]
xpos=adjustxpos(xpos,xmargin,radx)
ypos=nodes$ypos[nodes$name==to]
end=c(xpos,ypos)
if(nchar(label)>1) {
if(nchar(label==3)){
temp1=paste0("expression(",substr(label,1,1),"[",substr(label,2,2),"]","[",substr(label,3,nchar(label)),"])")
} else{
temp2=substr(label,2,nchar(label))
temp2
temp1=paste0("expression(",substr(label,1,1),"[",temp2,"])")
temp1
}
temp=eval(parse(text=temp1))
label=temp
}
myarrow(from=start,to=end,label=label,label.pos=label.pos,arr.pos=arr.pos,...)
}
statisticalDiagram(no=1)
statisticalDiagram(no=2)
statisticalDiagram(no=4)
statisticalDiagram(no=5)
statisticalDiagram(no=7)
statisticalDiagram(no=8)
statisticalDiagram(no=9)
statisticalDiagram(no=10)
statisticalDiagram(no=14)
statisticalDiagram(no=15)
statisticalDiagram(no=16)
statisticalDiagram(no=17)
statisticalDiagram(no=21)
statisticalDiagram(no=22)
statisticalDiagram(no=23)
shiny::runApp('inst/pmacro')
statisticalDiagram(no=1)
statisticalDiagram(no=49)
statisticalDiagram(no=50)
statisticalDiagram(no=51)
statisticalDiagram(no=51)
statisticalDiagram(no=22)
statisticalDiagram(no=23)
statisticalDiagram(no=24)
statisticalDiagram(no=28)
statisticalDiagram(no=29)
statisticalDiagram(no=30)
statisticalDiagram(no=31)
statisticalDiagram(no=32)
statisticalDiagram(no=36)
statisticalDiagram(no=40)
statisticalDiagram(no=41)
statisticalDiagram(no=45)
statisticalDiagram(no=45,radx=0.06)
statisticalDiagram(no=49)
statisticalDiagram(no=50)
statisticalDiagram(no=51)
statisticalDiagram(no=50)
statisticalDiagram(no=51)
statisticalDiagram(no=50)
statisticalDiagram(no=51)
