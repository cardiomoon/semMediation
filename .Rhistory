hlabel=c(hlabel,"","Coef","SE","t","p")
}
hlabel
hlabel=c("Antecedent","Coef","SE","t","p")
if(count>1){
for(i in 2:count){
hlabel=c(hlabel,"","Coef","SE","t","p")
}
}
hlabel
hlabellist=list()
hlabel1=list()
hlabel
hlabel1=list()
for(i in 1:length(col_keys)) hlabel1[[col_keys]]=hlabel[i]
for(i in 1:length(col_keys)) hlabel1[[col_keys[i]]]<-hlabel[i]
hlabel1
ft %>% set_header_labels(hlabel1)
ft %>% set_header_labels(hlabel1)
ft %>% add_header(hlabel1)
hlabel
hlabel1=list()
for(i in 1:length(col_keys)) hlabel1[[col_keys[i]]]<-hlabel[i]
hlabel1
hlabel
hlabel1=list()
hlabel[[1]]="Antecedent"
hlabel1=c("Antecedent","Coef","SE","t","p")
hlabel1=c("Antecedent","Coef","SE","t","p")
for(i in 1:count){
hlabel1=c(hlabel1,"","Coef","SE","t","p")
}
hlabel1
hlabel1<-as.list(hlabel1)
hlabel1
hlabel1=c("Antecedent","Coef","SE","t","p")
hlabel1=c("Antecedent","Coef","SE","t","p")
if(count>1){
for(i in 2:count){
hlabel1=c(hlabel1,"","Coef","SE","t","p")
}
}
hlabel1
hlabel1<-as.list(hlabel1)
hlabel1
hlabel1=c("Antecedent","Coef","SE","t","p")
if(count>1){
for(i in 2:count){
hlabel1=c(hlabel1,"","Coef","SE","t","p")
}
}
hlabel1<-as.list(hlabel1)
hlabel1
setNames(hlabel1,hlabel)
hlabel1
setNames(hlabel1,hlabel)
hlabel1<-lsetNames(hlabel1,hlabel)
hlabel1<-setNames(hlabel1,hlabel)
hlabel1
ft %>% set_header_labels(hlabel1)
hlabel=c("Antecedent","Coef","SE","t","p")
if(count>1){
for(i in 2:count){
hlabel=c(hlabel,"","Coef","SE","t","p")
}
}
hlabel1=c("Antecedent","Coef","SE","t","p")
if(count>1){
for(i in 2:count){
hlabel1=c(hlabel1,"","Coef","SE","t","p")
}
}
hlabel1<-setNames(hlabel1,hlabel)
hlabel1
hlabel=c("Antecedent","Coef","SE","t","p")
if(count>1){
for(i in 2:count){
hlabel=c(hlabel,"","Coef","SE","t","p")
}
}
hlabel
setNames(hlabel,col_keys)
hlabel<-setNames(hlabel,col_keys)
hlabel
ft %>% set_header_labels(hlabel1)
hlabel=as.list(hlabel)
hlabel
ft %>% set_header_labels(hlabel)
hlabel=c("Antecedent","Coef","SE","t","p")
if(count>1){
for(i in 2:count){
hlabel=c(hlabel,"","Coef","SE","t","p")
}
}
hlabel<-setNames(hlabel,col_keys)
hlabel
ft %>% set_header_labels(hlabel)
values = list(Sepal.Length = "Sepal length",
Sepal.Width = "Sepal width",
Petal.Length = "Petal length",
Petal.Width = "Petal width" )
values
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
ft
ft %>% set_header_labels(values=hlabel)
for(i in 1:count){
ft<-ft %>% merge_h_range(i=(count-4):count,j1=5*(i-1)+2,j2=5*(i-1)+5)
}
ft
ft<-ft %>% set_header_labels(values=hlabel)
ft
for(i in 1:count){
ft<-ft %>% merge_h_range(i=(linecount-4):linecount,j1=5*(i-1)+2,j2=5*(i-1)+5)
}
ft
for(i in 1:count){
ft<-ft %>% merge_h_range(i=(rowcount-4):rowcount,j1=5*(i-1)+2,j2=5*(i-1)+5)
}
ft
ft<- ft %>% align(align="center",part="all") %>%
hline_top(part="header",border=fp_border(color="white",width=0))
ft
ft
for(i in 1:count){
ft <- ft %>% hline_top(j=((i-1)*5+2):((i-1)*5+5),part="header",border=fp_border(color="black",width=1))
}
ft
big_border=fp_border(color="black",width=2)
hlabel=c(modelNames[1],rep("",4))
for(i in 2:count){
hlabel=c(modelNames[i],rep("",4))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
hlabel=c(modelNames[1],rep("",4))
for(i in 2:count){
hlabel=c(modelNames[i],rep("",4))
}
hlabel<-setNames(hlabel,col_keys)
hlabel
hlabel=c(modelNames[1],rep("",4))
for(i in 2:count){
hlabel=c(hlabel,modelNames[i],rep("",4))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
ft<-ft %>% add_header(values=hlabel)
ft
hlabel=c(modelNames[1],rep("",4))
for(i in 2:count){
hlabel=c(hlabel,modelNames[i],rep("",4))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
ft %>% add_header(values=hlabel)
ft
hlabel=c("",modelNames[1],rep("",4))
for(i in 2:count){
hlabel=c(hlabel,modelNames[i],rep("",4))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
hlabel=c("",modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
ft %>% add_header(values=hlabel)
hlabel=c("",modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
ft %>% add_header(top=TRUE,hlabel)
ft
ft %>% add_header(top=TRUE,values=hlabel)
ft %>% add_header(hlabel)
ft %>% add_header(values=hlabel)
ft %>% add_header(top=TRUE,values=hlabel)
ft %>% add_header(top=TRUE,hlabel)
ft %>% add_header_row(top=TRUE,value=hlabel)
hlabel
ft %>% add_header_row(top=TRUE,values=hlabel)
hlabel=c("",modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
ft %>% add_header_row(top=TRUE,values=hlabel)
length(hlabel)
length(hlabel)
ft %>% add_header_row(top=TRUE,values=hlabel)
length(col_keys)
length(hlabel)
hlabel=c("",modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
length(hlabel)
length(col_keys)
ft %>% add_header_row(top=TRUE,values=hlabel)
ft %>% add_header(top=TRUE,values=hlabel)
ft %>% add_header_row(top=TRUE,values=hlabel)
hlabel=c("",modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
length(hlabel)
length(col_keys)
ft %>% add_header_row(top=TRUE,values=hlabel)
ft %>% add_header_row(values=hlabel)
ft
hlabel=c(modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=c(modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys[-1])
hlabel=as.list(hlabel)
hlabel
length(hlabel)
length(col_keys)
ft %>% add_header(values=hlabel,top=TRUE)
ft %>% add_header_row(values=hlabel,top=TRUE)
hlabel=c("",modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys[-1])
hlabel=as.list(hlabel)
hlabel
hlabel=c("",modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
length(hlabel)
length(col_keys)
ft
add_header(ft,values=hlabel,top=TRUE)
add_header(ft,value=hlabel,top=TRUE)
add_header_row(ft,values=hlabel,top=TRUE)
install.packages("flextable")
require(flextable)
ft
hlabel
length(hlabel)
length(col_keys)
add_header_row(ft,values=hlabel,top=TRUE)
add_header_row(ft,values=hlabel,top=TRUE,colwidths=rep(1,15))
ft <- add_header_row(ft,values=hlabel,top=TRUE,colwidths=rep(1,15))
ft
ft <- ft %>%
hline_top(j=2:count*5,part="header",border=fp_border(color="black",width=1))
require(tidyverse)
ft <- ft %>%
hline_top(j=2:count*5,part="header",border=fp_border(color="black",width=1))
require(flextable)
require(officer)
ft <- ft %>%
hline_top(j=2:count*5,part="header",border=fp_border(color="black",width=1))
ft
ft <- ft %>%
hline_top(j=2:count*5,part="header",border=fp_border(color="black",width=1))
ft
ft <- ft %>%
hline_top(j=2:(count*5),part="header",border=fp_border(color="black",width=1))
ft
ft
for(i in 1:count){
ft<-ft %>% hline(i=1,j=((i-1)*5+2):((i-1)*5+5),part="header",border=fp_border(color="black",width=1))
}
ft
for(i in 1:count){
ft <- ft %>% merge_h_range (i=1,j1=(i-1)*5+2,j2=(i-1)*5+5,part="header")
}
ft
ft %>% add_header_row(name1="",coef1="Consequent",top=TRUE,colwidths=c(1,count*5-1))
ft %>% add_header(name1="",coef1="Consequent",top=TRUE,colwidths=c(1,count*5-1))
hlabel=list(name1="",coef1="Consequent")
ft %>% add_header_row(top=TRUE,values=hlabel,colwidths=c(1,count*5-1))
ft %>% add_header_row(top=TRUE,values=hlabel,colwidths=c(1,count*5-1)) %>%
hline_top(part="header",border=big_border) %>%
hline(i=1,j=2:(count*5),part="header",border=fp_border(color="black",width=1))%>%
merge_h_range (i=1,j1=2,j2=count*5,part="header") %>%
align(align="center",part="all") %>%
bold(part="header") %>%
fontsize(part="all",size=12) %>%
hline(i=rowcount-5,border=fp_border(color="gray"),part="body")
ft<-ft %>% add_header_row(top=TRUE,values=hlabel,colwidths=c(1,count*5-1)) %>%
hline_top(part="header",border=big_border) %>%
hline(i=1,j=2:(count*5),part="header",border=fp_border(color="black",width=1))%>%
merge_h_range (i=1,j1=2,j2=count*5,part="header") %>%
align(align="center",part="all") %>%
bold(part="header") %>%
fontsize(part="all",size=12) %>%
hline(i=rowcount-5,border=fp_border(color="gray"),part="body")
ft
for(i in 1:(count-1)){
ft<-ft %>% width(j=i*5+1,width=0.01)
}
ft
for(i in 1:(count)){
ft<-ft %>% italic(i=3,j=c(((i-1)*5+3):((i-1)*5+5)),italic=TRUE,part="header")
}
ft
devtools::document()
devtools::document()
library(semMediation)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
modelsSummary(fit1)
modelsSummary(fit1,fit2)
modelsSummary(fit1,fit2,fit3)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
x=modelsSummary(fit1)
modelsSummaryTable(x)
x=modelsSummary(fit1,fit2)
modelsSummaryTable(x)
x=modelsSummary(fit1,fit2,fit3)
modelsSummaryTable(x)
x=modelsSummary(fit1)
modelsSummaryTable(x)
x=modelsSummary(fit1)
modelNames=attr(x,"modelNames")
modelNames
result=x
count=ncol(x)/4
count
result[["name1"]]=rownames(result)
if(count>1){
for(i in 2:count) result[[paste0("s",(i-1))]]=""
}
result<-result %>% select("name1",everything())
rowcount=nrow(result)
col_keys=c("name1",names(result)[2:5])
if(count>1){
for(i in 1:(count-1))
col_keys=c(col_keys,paste0("s",i),names(result)[(i*4+2):(i*4+5)])
}
ft<-flextable(result,col_keys=col_keys)
ft
hlabel=c("Antecedent","Coef","SE","t","p")
if(count>1){
for(i in 2:count){
hlabel=c(hlabel,"","Coef","SE","t","p")
}
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
ft<-ft %>% set_header_labels(values=hlabel)
for(i in 1:count){
ft<-ft %>% merge_h_range(i=(rowcount-4):rowcount,j1=5*(i-1)+2,j2=5*(i-1)+5)
}
ft<- ft %>% align(align="center",part="all") %>%
hline_top(part="header",border=fp_border(color="white",width=0))
ft
for(i in 1:count){
ft <- ft %>% hline_top(j=((i-1)*5+2):((i-1)*5+5),part="header",border=fp_border(color="black",width=1))
}
big_border=fp_border(color="black",width=2)
hlabel=c("",modelNames[1],rep("",3))
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
length(hlabel)
hlabel=c("",modelNames[1],rep("",3))
if(count>1){
for(i in 2:count){
hlabel=c(hlabel,"",modelNames[i],rep("",3))
}
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
length(hlabel)
length(col_keys)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
x=modelsSummary(fit1)
library(semMediation)
devtools::document()
library(semMediation)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
x=modelsSummary(fit1)
modelsSummaryTable(x)
x=modelsSummary(fit1,fit2)
modelsSummaryTable(x)
x=modelsSummary(fit1,fit2,fit3)
modelsSummaryTable(x)
x=modelsSummary(fit1)
modelsSummaryTable(x)
x=modelsSummary(fit1,fit2)
modelsSummaryTable(x)
x=modelsSummary(fit1,fit2,fit3)
modelsSummaryTable(x)
library(semMediation)
fit=lm(mpg~wt,data=mtcars)
getInfo(fit)
devtools::document()
library(semMediation)
fit=lm(mpg~wt,data=mtcars)
getInfo(fit)
fmt=paste0("%.0",digits,"f")
r1=nrow(fit$model)
x<-summary(fit)
r2=sprintf(fmt,x$r.squared)
r3=sprintf(fmt,x$adj.r.squared)
r4=paste0(sprintf(fmt,x$sigma)," ( df = ",round(x$df[2]),")")
digits=3
fit=lm(mpg~wt,data=mtcars)
fmt=paste0("%.0",digits,"f")
r1=nrow(fit$model)
x<-summary(fit)
r2=sprintf(fmt,x$r.squared)
r3=sprintf(fmt,x$adj.r.squared)
r4=paste0(sprintf(fmt,x$sigma)," ( df = ",round(x$df[2]),")")
f=paste0("F(",round(x$fstatistic[2]),",",round(x$fstatistic[3]),") = ",
sprintf(fmt,x$fstatistic[1]))
p=format.pval(pf(x$fstatistic[1L],
x$fstatistic[2L], x$fstatistic[3L], lower.tail = FALSE),
digits = 3)
p
p=format.pval(pf(x$fstatistic[1L],
x$fstatistic[2L], x$fstatistic[3L], lower.tail = FALSE),
digits = 3)
p
sprintf("%0.5f",p)
p=format.pval(pf(x$fstatistic[1L],
x$fstatistic[2L], x$fstatistic[3L], lower.tail = FALSE),
digits = 3)
p
p=sprintf("%0.5f",pf(x$fstatistic[1L],
x$fstatistic[2L], x$fstatistic[3L], lower.tail = FALSE))
p
p=substr(p,2,digits+2)
if(p==".000") p="< .001"
p=sprintf("%0.4f",pf(x$fstatistic[1L],
x$fstatistic[2L], x$fstatistic[3L], lower.tail = FALSE))
p
p=substr(p,2,digits+2)
if(p==".000") p="< .001"
else p=paste0("= ",p)
f=paste0(f,", p ",p)
result=c(r1,r2,r3,r4,f)
result
library(semMediation)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
x=modelsSummary(fit1)
modelsSummaryTable(x)
x=modelsSummary(fit1,fit2)
modelsSummaryTable(x)
x=modelsSummary(fit1,fit2,fit3)
modelsSummaryTable(x)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
modelsSummary(fit1)
modelsSummary(fit1,fit2)
modelsSummary(fit1,fit2,fit3)
library(semMediation)
devtools::check()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
library(semMediation)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
modelsSummary(fit1)
modelsSummary(fit1,fit2)
fit3=lm(mpg~wt*hp*am,data=mtcars)
modelsSummary(fit1,fit2,fit3)
