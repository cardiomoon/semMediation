ft
ft<-ft %>%
hline_top(part="header",border=fp_border(color="white",width=0)) %>%
hline_top(j=2:5,part="header",border=fp_border(color="black",width=1)) %>%
hline_top(j=7:10,part="header",border=fp_border(color="black",width=1))
ft
big_border=fp_border(color="black",width=2)
ft %>%
add_header(coef1=M,se1="",t1="",p1="",s="",coef2=Y,se2="",t2="",p2="",top=TRUE) %>%
hline_top(j=2:10,part="header",border=fp_border(color="black",width=1)) %>%
hline(i=1,j=2:5,part="header",border=fp_border(color="black",width=1)) %>%
hline(i=1,j=7:10,part="header",border=fp_border(color="black",width=1))%>%
merge_h_range (i=1,j1=2,j2=5,part="header") %>%
merge_h_range (i=1,j1=7,j2=10,part="header") %>%
add_header(coef1="Consequent",se1="",t1="",p1="",s="",
coef2="",se2="",t2="",p2="",top=TRUE) %>%
hline_top(part="header",border=big_border) %>%
hline(i=1,j=2:10,part="header",border=fp_border(color="black",width=1))%>%
merge_h_range (i=1,j1=2,j2=10,part="header") %>%
align(align="center",part="all") %>%
bold(part="header") %>%
fontsize(part="header",size=12) %>%
hline(i=count-5,border=fp_border(color="gray"),part="body")%>%
width(j=6,width=0.01) %>%
italic(i=3,j=c(3:5,8:10),italic=TRUE,part="header")
}
x=modelsSummary(fitM,fitY)
x
modelsSummaryTable(x)
devtools::document()
devtools::document()
library(semMediation)
teams=read.csv("./inst/pmacro/data/teams.csv",stringsAsFactors = FALSE)
names(teams)
fitM=lm(negtone~dysfunc,data=teams)
summary(fitM)
fitY=lm(perform~dysfunc+negtone*negexp,data=teams)
names(fitY$coef)
summary(fitY)
x=modelsSummary(fitM,fitY)
x
stargazer::stargazer(fitM,fitY,type="text")
modelsSummary(fitM,fitY)
devtools::docuemnt()
devtools::document()
library(semMediation)
stargazer::stargazer(fitM,fitY,type="text")
modelsSummary(fitM,fitY)
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
library(semMediation)
library(semMediation)
runApp('inst/pmacro')
library(semMediation)
runApp('inst/pmacro')
fit=lm(mpg~wt*hp,data=mtcars)
fit=lm(mpg~wt*hp,data=mtcars)
sim_slopes(fit,pred=wt,modx=hp,digits=3,confint=TRUE)
require(jtools)
require(interactions)
require(ggplot2)
fit=lm(mpg~wt*hp,data=mtcars)
sim_slopes(fit,pred=wt,modx=hp,digits=3,confint=TRUE)
ss=sim_slopes(fit,pred=wt,modx=hp,digits=3,confint=TRUE)
plot(ss)
plot(ss)+labs(x="중량")
plot(ss)+labs(x="중량")+theme(text=element_text(family="NanumGothic"))
johnson_neyman(fit,pred=wt,modx=hp)
johnson_neyman(fit,pred=wt,modx=hp)+labs(x="중량")+theme(text=element_text(family="NanumGothic"))
johnson_neyman(fit,pred=wt,modx=hp)
johnson_neyman(fit,pred=wt,modx=hp)$plot+labs(x="중량")+theme(text=element_text(family="NanumGothic"))
shiny::runApp('inst/pmacro')
runApp('inst/pmacro')
caskets=read.csv("./inst/pmacro/data/caskets.csv",stringsAsFactors = FALSE)
caskets
fit=lm(interest~age*policy,data=caskets)
summary(fit)
interact_plot(fit,pred=age,modx=policy)
library(interactions)
interact_plot(fit,pred=age,modx=policy)
interact_plot(fit,pred=age,modx=policy)
shiny::runApp('inst/pmacro')
runApp('inst/pmacro')
X="negemot";M="ideology";Y="govact";suffix=0
cat(tripleEquation(X=X,M=M,Y=Y))
vars=list(name=list(c("sex","age")),site=list(c("a")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
vars=list(name=list(c("sex","age")),site=list(c("b","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
vars=list(name=list(c("sex","age")),site=list(c("a","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
vars=list(name=list(c("sex","age"),c("ese","sex")),site=list(c("a","b"),"c"))
seekNameVars(vars,"c")
X="negemot";M="ideology";Y="govact";suffix=0
vars=list(name=list(c("X","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
moderator=list();covar=NULL;mode=0;M=NULL
# cat("str(vars)\n")
str(vars)
temp1<-temp2<-temp3<-temp4<-NULL
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
res=seekNameVars(vars,"a")
res
res=seekNameVars(vars,"b")
res
res=seekNameVars(vars,"c")
res
res=seekNameVars(vars,"c")
res
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c"))
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
seekNameVars(vars,"c")
seekNameVars(vars,"a")
seekNameVars(vars,"b")
seekNameVars(vars,"c")
seekNameVars(vars,"a")
seekNameVars(vars,"b")
seekNameVars(vars,"c")
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("a")))
seekNameVars(vars,"a")
seekNameVars(vars,"b")
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("a")))
seekNameVars(vars,"a")
seekNameVars(vars,"b")
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("a")))
seekNameVars(vars,"a")
seekNameVars(vars,"b")
seekNameVars(vars,"c")
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
seekNameVars(vars,"a")
seekNameVars(vars,"b")
seekNameVars(vars,"c")
site="a"
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
lapply(vars$site,str_detect,site)
lapply(lapply(vars$site,str_detect,site),any)
unlist(lapply(lapply(vars$site,str_detect,site),any))
which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
site="c"
which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
seelct=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
site="c"
seelct=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
select
vars$name[select]
site="a"
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
select
vars$name[select]
site="a"
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
select
unlist(vars$name[select])
site="b"
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
select
unlist(vars$name[select])
site="c"
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
select
unlist(vars$name[select])
site="c"
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
select
vars$name[select]
result=vars$name[select]
site="a"
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
select
result=vars$name[select]
result
length(result)
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
seekNameVars(vars,"a")
#' select names of variables from list var
#' @param vars A list
#' @param site Site for look kor
#' @export
#' @examples
#' vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
#' seekNameVars(vars,"a")
#' seekNameVars(vars,"b")
#' seekNameVars(vars,"c")
seekNameVars=function(vars,site="a"){
result<-NULL
if(!is.null(vars)){
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
result<-vars$name[select]
}
result
}
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
seekNameVars(vars,"a")
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
seekNameVars(vars,"b")
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
seekNameVars(vars,"c")
res=seekNameVars(vars,"a")
res
res[[1]]
source('~/ownCloud/Documents/semMediation/R/tripleInteraction.R', echo=TRUE)
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
seekNameVars(vars,"a")
seekNameVars(vars,"b")
seekNameVars(vars,"c")
#' select names of variables from list var
#' @param vars A list
#' @param site Site for look kor
#' @export
#' @examples
#' vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
#' seekNameVars(vars,"a")
#' seekNameVars(vars,"b")
#' seekNameVars(vars,"c")
seekNameVars=function(vars,site="a"){
result<-NULL
if(!is.null(vars)){
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
result<-vars$name[select]
}
result
}
X="negemot";M="ideology";Y="govact";suffix=0
vars=list(name=list(c("sex","age")),site=list(c("a","c")))
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
source('~/ownCloud/Documents/semMediation/R/tripleInteraction.R', echo=TRUE)
X="negemot";M="ideology";Y="govact";suffix=0
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","b","c"),c("a","b","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
res=seekNameVars(vars,"a")
res
X
temp1<-temp2<-temp3<-temp4<-NULL
if(!is.null(res)) {
for(i in 1:length(res)){
newvars=c(X,res[[i]])
temp1=c(temp1,tripleInteraction(newvars,prefix="a",suffix=suffix,mode=mode,addPrefix=FALSE))
suffix=suffix+1
}
}
temp1
res=seekNameVars(vars,"c")
res
if(!is.null(res)) {
for(i in 1:length(res)){
newvars=c(X,res[[i]])
temp3=c(temp3,tripleInteraction(newvars,suffix=suffix,mode=mode,addPrefix=FALSE))
}
}
temp3
source('~/ownCloud/Documents/semMediation/R/tripleInteraction.R', echo=TRUE)
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","b","c"),c("a","b","c")))
X="negemot";M="ideology";Y="govact";suffix=0
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
runApp('inst/pmacro')
X="negemot";M="ideology";Y="govact";suffix=0
vars=list(name=list(c("sex","age")),site=list(c("a","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
library(semMediation)
X="negemot";M="ideology";Y="govact";suffix=0
cat(tripleEquation(X=X,M=M,Y=Y))
vars=list(name=list(c("sex","age")),site=list(c("a","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
moderator=list();covar=NULL;mode=0;M=NULL
temp1<-temp2<-temp3<-temp4<-NULL
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
res=seekNameVars(vars,"a")
if(!is.null(res)) {
for(i in 1:length(res)){
newvars=c(X,res[[i]])
temp1=c(temp1,tripleInteraction(newvars,prefix="a",suffix=suffix,mode=mode,addPrefix=FALSE))
suffix=suffix+1
}
}
temp1
if(!is.null(M)){
XM=c(X,XM)
XMstr=interactStr(XM,addPrefix=FALSE)
temp1=union(temp1,XMstr)
if(mode==0) temp1=paste0("a",1:length(temp1),"*",temp1)
temp4=paste0(M,"~",paste(temp1,collapse="+"))
if(!is.null(covar)){
covar$site=lapply(covar$site,function(x) str_replace(x,"M",M))
if(mode){
temp4=addCovarEquation(temp4,covar,prefix=NULL)
} else{
temp4=addCovarEquation(temp4,covar)
}
}
}
res=seekNameVars(vars,"b")
res
length(res)
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
vars=list(name=list(c("W","Z")),site=list(c("a","c")))
seekNameVars(vars,"a")
seekNameVars(vars,"b")
seekNameVars(vars,"c")
X="negemot";M="ideology";Y="govact";suffix=0
library(semMediation)
X="negemot";M="ideology";Y="govact";suffix=0
vars=list(name=list(c("sex","age")),site=list(c("a","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","b","c"),c("a","b","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
caskets=read.csv("./data/caskets.csv",stringsAsFactors = FALSE)
caskets=read.csv("./inst/pmacro/data/caskets.csv",stringsAsFactors = FALSE)
fit=lm(interest ~ age*policy*educ+age,data=caskets)
summary(fit)
temp="interact_plot(fit,pred=age,modx=policy,plot.points=FALSE,interval=FALSE,int.type='confidence',int.width=0.95,linearity.check=FALSE)"
eval(parse(text=temp))
interact_plot(fit,pred=age,modx=policy,plot.points=FALSE,interval=FALSE,int.type='confidence',int.width=0.95,linearity.check=FALSE)
interact_plot(fit,pred="age",modx="policy",plot.points=FALSE,interval=FALSE,int.type='confidence',int.width=0.95,linearity.check=FALSE)
p<-interact_plot(fit,pred="age",modx="policy",plot.points=FALSE,interval=FALSE,int.type='confidence',int.width=0.95,linearity.check=FALSE)
p
p+theme(text=element_text(famly="NanumGothic"))
p+theme(text=element_text(family="NanumGothic"))
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
glbwarm=read.csv("./data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm=read.csv("./inst/pmacro/data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm
glbwarm$interaction0=glbwarm$negemot*glbwarm$age*glbwarm$sex
glbwarm$interaction1=glbwarm$interaction0
model="ideology ~ a1*negemot+a2*age+a3*sex+a4*negemot:age+a5*negemot:sex+a6*age:sex+a7*interaction0
govact ~ b1*ideology+c1*negemot+c2*age+c3*sex+c4*negemot:age+c5*negemot:sex+c6*age:sex+c7*interaction1
age ~ age.mean*1
age ~~ age.var*age
sex ~ sex.mean*1
sex ~~ sex.var*sex
indirect :=(a1+a4*age.mean+a5*sex.mean)*(b1)
direct :=c1+c4*age.mean+c5*sex.mean
total := direct + indirect
indirect.SDbelow :=(a1+a4*(age.mean-sqrt(age.var))+a5*(sex.mean-sqrt(sex.var)))*(b1)
indirect.SDabove :=(a1+a4*(age.mean+sqrt(age.var))+a5*(sex.mean+sqrt(sex.var)))*(b1)
direct.SDbelow:=c1+c4*(age.mean-sqrt(age.var))+c5*(sex.mean-sqrt(sex.var))
direct.SDabove:=c1+c4*(age.mean+sqrt(age.var))+c5*(sex.mean+sqrt(sex.var))
total.SDbelow := direct.SDbelow + indirect.SDbelow
total.SDabove := direct.SDabove + indirect.SDabove
prop.mediated.SDbelow := indirect.SDbelow / total.SDbelow
prop.mediated.SDabove := indirect.SDabove / total.SDabove
"
library(lavaan)
fit=sem(model=model,data=glbwarm)
glbwarm=read.csv("./inst/pmacro/data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm$interaction0=glbwarm$negemot*glbwarm$age*glbwarm$sex
model="ideology ~ a1*negemot+a2*age+a3*sex+a4*negemot:age+a5*negemot:sex+a6*age:sex+a7*interaction0
govact ~ b1*ideology+c1*negemot+c2*age+c3*sex+c4*negemot:age+c5*negemot:sex+c6*age:sex+c7*interaction0
age ~ age.mean*1
age ~~ age.var*age
sex ~ sex.mean*1
sex ~~ sex.var*sex
indirect :=(a1+a4*age.mean+a5*sex.mean)*(b1)
direct :=c1+c4*age.mean+c5*sex.mean
total := direct + indirect
indirect.SDbelow :=(a1+a4*(age.mean-sqrt(age.var))+a5*(sex.mean-sqrt(sex.var)))*(b1)
indirect.SDabove :=(a1+a4*(age.mean+sqrt(age.var))+a5*(sex.mean+sqrt(sex.var)))*(b1)
direct.SDbelow:=c1+c4*(age.mean-sqrt(age.var))+c5*(sex.mean-sqrt(sex.var))
direct.SDabove:=c1+c4*(age.mean+sqrt(age.var))+c5*(sex.mean+sqrt(sex.var))
total.SDbelow := direct.SDbelow + indirect.SDbelow
total.SDabove := direct.SDabove + indirect.SDabove
prop.mediated.SDbelow := indirect.SDbelow / total.SDbelow
prop.mediated.SDabove := indirect.SDabove / total.SDabove
"
library(lavaan)
fit=sem(model=model,data=glbwarm)
summary(fit)
runApp('inst/pmacro')
X="negemot";M="ideology";Y="govact";suffix=0
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
seekNameVars(vars,"a")
seekNameVars(vars,"b")
seekNameVars(vars,"c")
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
site="a"
lapply(lapply(vars$site,str_detect,site),any)
unlist(lapply(lapply(vars$site,str_detect,site),any))
which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
site="b"
which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
site="c"
which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
#' select names of variables from list var
#' @param vars A list
#' @param site Site for look kor
#' @export
#' @examples
#' vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
#' vars=list(name=list(c("W","Z")),site=list(c("a","c")))
#' seekNameVars(vars,"a")
#' seekNameVars(vars,"b")
#' seekNameVars(vars,"c")
seekNameVars=function(vars,site="a"){
result<-c()
if(!is.null(vars)){
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
result<-select
}
result
}
site="c"
#' select names of variables from list var
#' @param vars A list
#' @param site Site for look kor
#' @export
#' @examples
#' vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
#' vars=list(name=list(c("W","Z")),site=list(c("a","c")))
#' seekNameVars(vars,"a")
#' seekNameVars(vars,"b")
#' seekNameVars(vars,"c")
seekNameVars=function(vars,site="a"){
result<-c()
if(!is.null(vars)){
select=which(unlist(lapply(lapply(vars$site,str_detect,site),any)))
result<-select
}
result
}
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","c"),c("b","c")))
seekNameVars(vars,"a")
seekNameVars(vars,"b")
seekNameVars(vars,"c")
vars=list(name=list(c("W","Z")),site=list(c("a","c")))
seekNameVars(vars,"b")
seekNameVars(vars,"b")
length(seekNameVars(vars,"b"))
vars=list(name=list(c("sex","age")),site=list(c("a","c")))
vars=list(name=list(c("W","Z"),c("V","Q")),site=list(c("a","b","c"),c("a","b","c")))
vars$name[[1]]
source('~/ownCloud/Documents/semMediation/R/tripleInteraction.R', echo=TRUE)
X="negemot";M="ideology";Y="govact";suffix=0
vars=list(name=list(c("sex","age")),site=list(c("a","c")))
cat(tripleEquation(X=X,M=M,Y=Y,vars=vars))
runApp('inst/pmacro')
runApp('inst/pmacro')
res=mtcars
seek=c("hp","wt")
replace=paste0(seek,"rep")
seek
replace
colnames(res)[colnames(res)==seek]=replace
for(i in seq_along(seek)) colnames(res)[colnames(res)==seek[i]]=replace[i]
res
colnames(res)
seek=c("hp","wt")
seek
replace=paste0(seek,"rep")
replace
res=mtcars
colnames(res)
seek=c("hp","wt")
seek
replace=paste0(seek,"rep")
replace
for(i in seq_along(seek)) {
colnames(res)[colnames(res)==seek[i]]=replace[i]
}
colnames(res)
runApp('inst/pmacro')
runApp('inst/pmacro')
fit=lm(mpg~hp*wt+am,data=mtcars)
library(ggiraphExtra)
library(intreactions)
fit=lm(mpg~hp*wt+am,data=mtcars)
fit=lm(mpg~hp*wt+am,data=mtcars)
fit1=lm(mpg~hp*wt+am,data=mtcars)
fit2=lm(mpg~hp*wt+am,data=mtcars)
interact_plot(fit1,pred=hp,modx=wt)
interact_plot(fit2,pred=hp,modx=wt)
fit1=lm(mpg~hp*wt,data=mtcars)
fit2=lm(mpg~hp*wt+cyl,data=mtcars)
interact_plot(fit1,pred=hp,modx=wt)
interact_plot(fit2,pred=hp,modx=wt)
interact_plot(fit1,pred=hp,modx=wt)
interact_plot(fit2,pred=hp,modx=wt)
ggPredict(fit1)
ggPredict(fit2)
fit2=lm(mpg~hp*wt+am,data=mtcars)
fit1=lm(mpg~hp*wt,data=mtcars)
fit2=lm(mpg~hp*wt+am,data=mtcars)
interact_plot(fit1,pred=hp,modx=wt)
interact_plot(fit2,pred=hp,modx=wt)
interact_plot(fit2,pred=hp,modx=wt,mod2=am)
ggPredict(fit2)
interact_plot(fit2,pred=hp,modx=wt,mod2=am)
ggPredict(fit2)
interact_plot(fit2,pred=hp,modx=wt,mod2=am)
ggPredict(fit2)
interact_plot(fit2,pred=hp,modx=wt,mod2=am)
runApp('inst/pmacro')
