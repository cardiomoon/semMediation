cat(rightprint(x[i,8],8),"\n")
}
}
x=modmedSummary(fit,mod="skeptic")
x
print.modemedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
for(i in 1:count){
cat(rightprint(x[i,1],8))
cat(rightprint(x[i,2],8))
cat(paste0(rightprint(x[i,3],6)," to ",rightprint(x[i,4],6)))
cat(rightprint(x[i,5],8))
cat(rightprint(x[i,6],8))
cat(rightprint(x[i,7],8))
cat(rightprint(x[i,8],8),"\n")
}
}
x
modmedSummary=function(fit,mod="skeptic",values=NULL){
res=parameterEstimates(fit)
res=res[res$label!="",]
res
if(is.null(values)){
values=res$est[res$label==paste0(mod,".mean")]+c(0,-1,1)*res$est[res$label==paste0(mod,".var")]
values
}
select=c("indirect","indirect.below","indirect.above")
indirect=res$est[which(res$lhs %in% select)]
lower=res$ci.lower[which(res$lhs %in% select)]
upper=res$ci.upper[which(res$lhs %in% select)]
indirectp=res$pvalue[which(res$lhs %in% select)]
select=c("direct","direct.below","direct.above")
direct=res$est[which(res$lhs %in% select)]
se=res$se[which(res$lhs %in% select)]
directp=res$p[which(res$lhs %in% select)]
df=data.frame(values,indirect,lower,upper,indirectp,direct,se,directp)
df=df[c(2,1,3),]
df[]=round(df,3)
class(df)=c("modmedSummary","data.frame")
df
}
x=modmedSummary(fit,mod="skeptic")
x
class(x)
print.modemedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
for(i in 1:count){
cat(rightprint(x[i,1],8))
cat(rightprint(x[i,2],8))
cat(paste0(rightprint(x[i,3],6)," to ",rightprint(x[i,4],6)))
cat(rightprint(x[i,5],8))
cat(rightprint(x[i,6],8))
cat(rightprint(x[i,7],8))
cat(rightprint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
for(i in 1:count){
cat(rightprint(x[i,1],8))
cat(rightprint(x[i,2],8))
cat(paste0(rightprint(x[i,3],6)," to ",rightprint(x[i,4],6)))
cat(rightprint(x[i,5],8))
cat(rightprint(x[i,6],8))
cat(rightprint(x[i,7],8))
cat(rightprint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],6)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],8))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
#' Print a string in center
#' @param string A string
#' @param width A numeric
#' @export
rightPrint=function(string,width){
str_pad(string,width,side="left")
}
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],6)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],8))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],8))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=64
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",8),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],8))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
#' Print a string in center
#' @param string A string
#' @param width A numeric
#' @export
centerPrint=function(string,width){
str_pad(string,width,side="both")
}
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=64
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",8),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],8))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=64
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],10))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=70
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],10))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=70
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",16),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],10))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=70
cat(centerPrint("",8),paste(rep("-",36),collapse = ""),paste(rep("-",24),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",16),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],10))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=70
cat(centerPrint("",8),paste(rep("-",36),collapse = ""),paste(rep("-",24),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],10))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=70
cat(centerPrint("",8),paste(rep("-",36),collapse = ""),paste(rep("-",24),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],12))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=70
cat(centerPrint("",8),paste(rep("-",36),collapse = ""),paste(rep("-",24),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],13))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=70
cat(centerPrint("",8),paste(rep("-",35),collapse = ""),paste(rep("-",24),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],13))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=71
cat(centerPrint("",8),paste(rep("-",35),collapse = ""),paste(rep("-",26),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],13))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=71
cat(centerPrint("",8),centerPrint("Indirect Effect",35),centerPrint("Direct Effect",26),"\n")
cat(centerPrint("",8),paste(rep("-",35),collapse = ""),paste(rep("-",26),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],13))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=71
cat(paste(rep("=",total),collapse = ""),"\n")
cat(centerPrint("",8),centerPrint("Indirect Effect",35),centerPrint("Direct Effect",26),"\n")
cat(centerPrint("",8),paste(rep("-",35),collapse = ""),paste(rep("-",26),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("=",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],13))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
cat(paste(rep("=",total),collapse = ""),"\n")
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=71
cat(paste(rep("=",total),collapse = ""),"\n")
cat(centerPrint("",8),centerPrint("Indirect Effect",35),centerPrint("Direct Effect",26),"\n")
cat(centerPrint("",8),paste(rep("-",35),collapse = ""),paste(rep("-",26),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("-",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],13))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
cat(paste(rep("=",total),collapse = ""),"\n")
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=71
cat("Inference for the Conditional Direct and Indirect Effects","\n")
cat(paste(rep("=",total),collapse = ""),"\n")
cat(centerPrint("",8),centerPrint("Indirect Effect",35),centerPrint("Direct Effect",26),"\n")
cat(centerPrint("",8),paste(rep("-",35),collapse = ""),paste(rep("-",26),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("-",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],13))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
cat(paste(rep("=",total),collapse = ""),"\n")
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=71
cat("\n\nInference for the Conditional Direct and Indirect Effects","\n")
cat(paste(rep("=",total),collapse = ""),"\n")
cat(centerPrint("",8),centerPrint("Indirect Effect",35),centerPrint("Direct Effect",26),"\n")
cat(centerPrint("",8),paste(rep("-",35),collapse = ""),paste(rep("-",26),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("-",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],13))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
cat(paste(rep("=",total),collapse = ""),"\n")
}
x
print.modmedSummary=function(x){
count=nrow(x)
x[]=lapply(x,myformat)
x[[5]]=pformat(x[[5]])
x[[8]]=pformat(x[[8]])
total=71
cat("\nInference for the Conditional Direct and Indirect Effects","\n")
cat(paste(rep("=",total),collapse = ""),"\n")
cat(centerPrint("",8),centerPrint("Indirect Effect",35),centerPrint("Direct Effect",26),"\n")
cat(centerPrint("",8),paste(rep("-",35),collapse = ""),paste(rep("-",26),collapse = ""),"\n")
cat(centerPrint("W",8),centerPrint("estimate",8),centerPrint("95% CI",18),centerPrint("p",8))
cat(centerPrint("estimate",10),centerPrint("SE",8),centerPrint("p",8),"\n")
cat(paste(rep("-",total),collapse = ""),"\n")
for(i in 1:count){
cat(rightPrint(x[i,1],8))
cat(rightPrint(x[i,2],8))
cat(paste0(rightPrint(x[i,3],8)," to ",rightPrint(x[i,4],6)))
cat(rightPrint(x[i,5],8))
cat(rightPrint(x[i,6],13))
cat(rightPrint(x[i,7],8))
cat(rightPrint(x[i,8],8),"\n")
}
cat(paste(rep("=",total),collapse = ""),"\n")
}
x
