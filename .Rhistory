arrows$name[413]
arrows$name[413]="b6"
arrows$name[414]="b7"
tail(arrows,10)
devtools::use_data(arrows,overwrite=TRUE)
statisticalDiagram(3)
tail(nodes)
tail(nodes,10)
nodes=editData(nodes)
tail(nodes,10)
statisticalDiagram(3)
devtools::use_data(nodes,overwrite=TRUE)
statisticalDiagram(2)
pmacroModel(2)
statisticalDiagram(2)
pmacroModel(2)
statisticalDiagram(2)
runApp('inst/pmacro')
pmacro
runApp('inst/pmacro')
pmacro
runApp('inst/pmacro')
library(semMediation)
pmacroModel(3)
statisticalmodel(3)
statisticalDiagram(3)
statisticalDiagram(2)
pmacroModel(2)
pmacroModel(3)
nodes[nodes$no==3,]
pmacro[pmacro$no==3,]
pmacro$modName[pmacro$no==3]
pmacro$modName[pmacro$no==3]="W"
pmacro$modName[pmacro$no==3]
devtools::use_data(pmacro,overwrite=TRUE)
library(semMediation)
pmacroModel(3)
nodes=editData::editData(nodes)
devtools::use_data(nodes,overwrite = TRUE)
arrows=editData::editData(arrows)
devtools::use_data(arrows,overwrite = TRUE)
statisticalDiagram(3)
pmacroModel(3)
runApp()
runApp()
}
vars=c("negemot","sex","age");dep="govact"
vars=c("negemot","sex","age");dep="govact"
combn(vars)
combn(vars,1)
combn(vars,2)
paste(vars,collapse="+")
temp=paste(vars,collapse="+")
temp
combn(vars,2)
apply(combn(vars,2),2,function(x){paste(x,collapse=":")}
}
apply(combn(vars,2),2,function(x){paste(x,collapse=":")})
temp2=apply(combn(vars,2),2,function(x){paste(x,collapse=":")})
temp2=apply(combn(vars,2),2,function(x){paste(x,collapse=":")})
paste(temp2,collapse="+")
paste(temp,paste(temp2,collapse="+"),sep="+")
#' @examples
vars=c("negemot","sex","age");dep="govact"
#' Make triple interaction equation
#' @examples
#' vars=c("negemot","sex","age");dep="govact"
#' tripleInteraction(vars,dep)
tripleInteraction=function(vars,dep,suffix=0){
temp=paste0(dep,"~",paste(vars,collapse="+"))
temp2=apply(combn(vars,2),2,function(x){paste(x,collapse=":")})
result=paste(temp,paste(temp2,collapse="+"),sep="+")
paste(result,paste0("interaction",suffix),sep="+")
}
vars=c("negemot","sex","age");dep="govact"
tripleInteraction(vars,dep)
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
var="M"
seekVar(covar,var,prefix=NULL)
#' Seek var form covariates
#' @param covar A list of covariates
#' @param var A name of variable to look for
#' @param prefix A prefix
#' @param start A start number
#' @export
#' @examples
#' covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
#' var="M"
#' seekVar(covar,var,prefix=NULL)
seekVar=function(covar=list(),var,prefix="h",start=1){
temp=c()
if(length(covar$name)>0){
j=start
for(i in 1:length(covar$name)){
# if(!is.null(covar$label[i])) var<-covar$label[i]
if(var %in% covar$site[[i]]){
if(!is.null(prefix)) {
temp=c(temp,paste0(prefix,j,"*",covar$name[i]))
} else{
temp=c(temp,covar$name[i])
}
j=j+1
}
}
}
temp
}
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
var="M"
seekVar(covar,var,prefix=NULL)
linrary(semMediation)
library(semMediation)
equation="Y ~ X*W"
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
addCovarEquation(equation,covar=covar,prefix=NULL)
shiny::runApp('inst/pmacro')
vars=c("negemot","sex","age");dep="govact"
tripleInteraction(vars,dep)
equation=tripleInteraction(vars,dep,suffix=suffix)
vars=c("negemot","sex","age");dep="govact";suffix=0
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
vars=c("negemot","sex","age");dep="govact";suffix=0
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
Y="govact"
equation=tripleInteraction(vars,dep,suffix=suffix)
temp=addCovarEquation(equation,covar,prefix="h")
temp
covar$site
lapply(covar$site,function(x) str_replace(x,"Y",Y))
covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
if(!is.null(M)) covar$site=lapply(covar$site,function(x) str_replace(x,"M",M))
#' @param Y Name of dependent variable
#' @param vars variable names to be interact
#' @param dep name of dependent variable
#' @param suffix A number
#' @param covar A list of covariates
#' @examples
#' vars=c("negemot","sex","age");dep="govact";suffix=0
#' covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
#' Y="govact"
#' tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar)
tripleEquation=function(M=NULL,Y,vars,dep,suffix=0,covar){
equation=tripleInteraction(vars,dep,suffix=suffix)
covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
if(!is.null(M)) covar$site=lapply(covar$site,function(x) str_replace(x,"M",M))
temp=addCovarEquation(equation,covar,prefix="h")
temp
}
vars=c("negemot","sex","age");dep="govact";suffix=0
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
Y="govact"
tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar)
apply(combn(vars,2),2,function(x){paste(x,collapse=":")})
result=vars
result=c(result,apply(combn(vars,2),2,function(x){paste(x,collapse=":")}))
result=c(result,paste0("interaction",suffix))
vars=c("negemot","sex","age");dep="govact"
tripleInteraction(vars,dep)
vars=c("negemot","sex","age");dep="govact"
result=vars
result=c(result,apply(combn(vars,2),2,function(x){paste(x,collapse=":")}))
result=c(result,paste0("interaction",suffix))
result
vars=c("negemot","sex","age");dep="govact"
result=vars
result=c(result,apply(combn(vars,2),2,function(x){paste(x,collapse=":")}))
result=c(result,paste0("interaction",suffix))
result
prefix="c"
paste0(prefix,1:length(result),result)
paste0(prefix,1:length(result),"*",result)
temp=paste0(prefix,1:length(result),"*",result)
result=vars
result=c(result,apply(combn(vars,2),2,function(x){paste(x,collapse=":")}))
result=c(result,paste0("interaction",suffix))
prefix="c"
temp=paste0(prefix,1:length(result),"*",result)
temp
paste0(dep,"~",paste(temp,collapse="+"))
vars=c("negemot","sex","age");dep="govact"
tripleInteraction(vars,dep)
#' Make triple interaction equation
#' @param vars variable names to be interact
#' @param dep name of dependent variable
#' @param prefix A character
#' @param suffix A number
#' @examples
#' vars=c("negemot","sex","age");dep="govact"
#' tripleInteraction(vars,dep)
tripleInteraction=function(vars,dep,prefix="c",suffix=0){
result=vars
result=c(result,apply(combn(vars,2),2,function(x){paste(x,collapse=":")}))
result=c(result,paste0("interaction",suffix))
temp=paste0(prefix,1:length(result),"*",result)
paste0(dep,"~",paste(temp,collapse="+"))
}
vars=c("negemot","sex","age");dep="govact"
tripleInteraction(vars,dep)
vars=c("negemot","sex","age");dep="govact";suffix=0
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
Y="govact"
tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar)
#' @param Y Name of dependent variable
#' @param vars variable names to be interact
#' @param dep name of dependent variable
#' @param suffix A number
#' @param covar A list of covariates
#' @examples
#' vars=c("negemot","sex","age");dep="govact";suffix=0
#' covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
#' M="govact"
#' tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar)
tripleEquation=function(M=NULL,Y=NULL,vars,dep,suffix=0,covar){
equation=tripleInteraction(vars,dep,suffix=suffix)
if(!is.null(Y)) covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
if(!is.null(M)) covar$site=lapply(covar$site,function(x) str_replace(x,"M",M))
temp=addCovarEquation(equation,covar,prefix="h")
temp
}
vars=c("negemot","sex","age");dep="govact";suffix=0
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
M="govact"
tripleEquation(M=M,vars=vars,dep=dep,covar=covar)
vars=c("negemot","sex","age");dep="govact";suffix=0
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
Y="govact"
tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar)
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
runApp('inst/pmacro')
glbwarm=read.csv("./inst/pmacro/data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm
attach(glbwarm)
glbwarm[["interaction0"]]=negemot*age*sex
saveRDS("interaction.RDS")
saveRDS(glbwarm,"interaction.RDS")
saveRDS(glbwarm,"./inst/pmacro/interaction.RDS")
runApp('inst/pmacro')
library(semMediation)
vars=c("negemot","sex","age");dep="govact"
tripleInteraction(vars,dep)
tripleInteraction(vars,dep)
tripleInteraction(vars,dep,mode=1)
#' Make triple interaction equation
#' @param vars variable names to be interact
#' @param dep name of dependent variable
#' @param prefix A character
#' @param suffix A number
#' @examples
#' vars=c("negemot","sex","age");dep="govact"
#' tripleInteraction(vars,dep)
#' tripleInteraction(vars,dep,mode=1)
tripleInteraction=function(vars,dep,prefix="c",suffix=0,mode=0){
if(mode){
temp=paste(vars,collapse="*")
} else{
result=vars
result=c(result,apply(combn(vars,2),2,function(x){paste(x,collapse=":")}))
result=c(result,paste0("interaction",suffix))
temp=paste0(prefix,1:length(result),"*",result)
}
paste0(dep,"~",paste(temp,collapse="+"))
}
tripleInteraction(vars,dep)
tripleInteraction(vars,dep,mode=1)
vars=c("negemot","sex","age");dep="govact";suffix=0
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
Y="govact"
tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar)
tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar,mode=1)
#' @param vars variable names to be interact
#' @param dep name of dependent variable
#' @param suffix A number
#' @param covar A list of covariates
#' @examples
#' vars=c("negemot","sex","age");dep="govact";suffix=0
#' covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
#' Y="govact"
#' tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar)
#' tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar,mode=1)
tripleEquation=function(M=NULL,Y=NULL,vars,dep,suffix=0,covar,mode=0){
equation=tripleInteraction(vars,dep,suffix=suffix,mode=mode)
if(!is.null(Y)) covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
if(!is.null(M)) covar$site=lapply(covar$site,function(x) str_replace(x,"M",M))
if(mode){
temp=addCovarEquation(equation,covar,prefix=NULL)
} else{
temp=addCovarEquation(equation,covar,prefix="h")
}
temp
}
tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar,mode=1)
vars=c("negemot","sex","age");dep="govact"
tripleInteraction(vars,dep)
tripleInteraction(vars,dep,mode=1)
library(semMediation)
vars=c("negemot","sex","age");dep="govact"
tripleInteraction(vars,dep)
tripleInteraction(vars,dep,mode=1)
devtools::document()
devtools::document()
library(semMediation)
vars=c("negemot","sex","age");dep="govact"
tripleInteraction(vars,dep)
tripleInteraction(vars,dep,mode=1)
vars=c("negemot","sex","age");dep="govact";suffix=0
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
Y="govact"
tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar)
tripleEquation(Y=Y,vars=vars,dep=dep,covar=covar,mode=1)
runApp()
runApp()
runApp()
runApp()
pmacroModel(3)
labels=list(X="negemot",Y="govact",W="age",Z="sex")
pmacroModel(3,labels=labels)
library(semMediation)
labels
pmacroModel(3,labels=labels)
library(ggplot2)
library(lavaan)
glbwarm=read.csv("./inst/pmacro/data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm
equation="
interaction:=negemot*sex*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
glbwarm=read.csv("./inst/pmacro/data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm
equation="
temp:=negemot*sex
interaction:=temp*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
glbwarm=read.csv("./inst/pmacro/data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm
equation="
interaction=negemot*temp*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
equation="
interaction=~negemot*temp*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
glbwarm=read.csv("./inst/pmacro/data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm
equation="
interaction=~negemot*sex*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
glbwarm=read.csv("./inst/pmacro/data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm
equation="
temp=~negemot*sex
interaction=~temp*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
parameterEstimates(semfit)
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
summary(fit)
equation="
temp=~negemot*sex
interaction=~temp*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
parameterEstimates(semfit)
summary(fit)
equation="
interaction=~negemot*sex*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
equation="
interaction=~negemot:sex*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
equation="
temp=~negemot:sex
interaction=~temp:age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
parameterEstimates(semfit)
summary(fit)
glbwarm=read.csv("./inst/pmacro/data/glbwarm.csv",stringsAsFactors = FALSE)
glbwarm
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
summary(fit)
equation="
temp=~negemot*sex
interaction=~temp*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
parameterEstimates(semfit)
equation="
temp=~negemot*sex
interaction=~temp*age
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
semfit=sem(model=equation,data=glbwarm)
parameterEstimates(semfit)
shiny::runApp('inst/pmacro')
library(semMediation)
attach(glbwarm)
glbwarm$interaction<-negemot*sex*age
equation="
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction+posemot+ideology"
fit=sem(model=equation,data=glbwarm)
parameterEstimates(fit)
estimatesTable(fit)
result=estimatesTable(fit)
result
result$Predictors[result$Predictors=="interaction0"]
attach(glbwarm)
glbwarm$interaction0<-negemot*sex*age
detach(glbwarm)
equation="
govact~negemot+sex+age+negemot:sex+negemot:age+sex:age+interaction0+posemot+ideology"
fit=sem(model=equation,data=glbwarm)
result=estimatesTable(fit)
result$Predictors[result$Predictors=="interaction0"]
runApp('inst/pmacro')
runApp('inst/pmacro')
library(semMediation)
runApp()
runApp()
fit
corTable(fit)
str(corTable(fit))
colnames(corTable(fit))
colnames(corTable(fit))[colnames(corTable(fit))=="interaction0"]
colnames(corTable(fit))[colnames(corTable(fit))=="interaction0"]
colnames(corTable(fit))[colnames(corTable(fit))=="interaction0"]="xxxx"
corTable(fit)
res=corTable(fit)
colnames(res)[colnames(res)=="interaction0"]="xxxx"
res
rownames(res)[rownames(res)=="interaction0"]="xxxx"
res
runApp()
library(semMediation)
library(semMediation)
runApp()
fit
data=fit@Data@X[[1]]
colnames(data)=fit@Data@ov$name
data=data.frame(data)
data
str(data)
library(semMediation)
runApp()
library(semMediation)
runApp()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::check()
runApp()
runApp()
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
summary(fit)
interact_plot(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70))
ss=sim_slopes(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70),johnson_neyman = FALSE,digits=3)
ss
plot(ss)
probe_interaction(fit,pred=negemot,modx=sex,mod2=age)
probe_interaction(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70))
probe_interaction(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70))
interact_plot(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70))
probe_interaction(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70))
sim_slopes(fit,pred=negemot,modx=sex,mod2=age,jnplot=TRUE)
sim_slopes(fit,pred=negemot,modx=age,mod2=sex,jnplot=TRUE)
interact_plot(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70))
ss=sim_slopes(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70),johnson_neyman = FALSE,digits=3)
ss
plot(ss)
probe_interaction(fit,pred=negemot,modx=sex,mod2=age)
sim_slopes(fit,pred=negemot,modx=sex,mod2=age,jnplot=TRUE)
interact_plot(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70))
ss=sim_slopes(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70),johnson_neyman = FALSE,digits=3)
ss
plot(ss)
interact_plot(fit,pred=negemot,modx=sex,mod2=age,mod2.values=c(30,50,70))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
library(semMediation)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
